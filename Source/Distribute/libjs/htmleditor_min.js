// htmleditor.js 2012-01-09 Copyright Longflow Enterprises Ltd. http://www.limnor.com

var HtmlEditor=HtmlEditor||{isEditing:false,borderStyle:['none','dotted','dashed','solid','double','groove','ridge','inset','outset'],textAlign:['','left','right','center','justify','inherit'],cssFloat:['','left','right','none','inherit'],verticalAlign:['','length in px','%','baseline','sub','super','top','text-top','middle','bottom','text-bottom','inherit'],fontStyles:['','normal','italic','oblique','inherit'],fontVariants:['','normal','small-caps','inherit'],fontWeights:['','normal','bold','bolder','lighter','100','200','300','400','500','600','700','800','900','inherit'],styleToCss:[{s:'fontFamily',c:'font-family'},{s:'fontSize',c:'font-size'},{s:'fontStyle',c:'font-style'},{s:'fontVariant',c:'font-variant'},{s:'fontWeight',c:'font-weight'}],createEditor:function(objEdited,finishHandler,initLocation){if(HtmlEditor.isEditing){return null;}
HtmlEditor.isEditing=true;var _divProp;var _titleTable;var _tdTitle;var _editorTable;var _parentList;var _propsBody;var _imgExpand;var _redbox;var _tableProps;var _selectedObject;var _isEditingBody;var _divSelectElement;var _newElementSelectTableBackColor='#E0FFFF';var _elementEditorList;var _addableElementList;var _commandList;var _resizer;var _nameresizer;var _isIE;var _ieVer;var _isFireFox;var _isOpera;var _fontCommands;var _fontSelect;var _addOptionWithNull;var _selection;var _range;var _selectedHtml;var _styleChanged;var _docType;var _saveToFolder;var _saveTo;var _resultHtml;var _editorStart='<!--editorstart-->';var _editorEnd='<!--editorend-->';var _editorStartJs='//editorstart';var _editorEndJs='//editorend';var _editorscript='//limnorstudiohtmleditor';var fontList=['','cursive','monospace','serif','sans-serif','fantasy','Arial','Arial Black','Arial Narrow','Arial Rounded MT Bold','Bookman Old Style','Bradley Hand ITC','Century','Century Gothic','Comic Sans MS','Courier','Courier New','Georgia','Gentium','Impact','King','Lucida Console','Lalit','Modena','Monotype Corsiva','Papyrus','Tahoma','TeX','Times','Times New Roman','Trebuchet MS','Verdana','Verona'];var fontSizes=['','xx-small','x-small','small','medium','large','x-large','xx-large','smaller','larger','size in px, cm, ...','%','inherit'];var _isEditingHtml=!objEdited;var _elementEdited=objEdited;var _finishHandler=finishHandler;if(_isEditingHtml){_elementEdited=document.body;}
if(_elementEdited==document.body){_isEditingBody=true;}
_ieVer=JsonDataBinding.getInternetExplorerVersion();_isIE=JsonDataBinding.IsIE();_isFireFox=JsonDataBinding.IsFireFox();_isOpera=JsonDataBinding.IsOpera();function addOptionToSelect(sel,op){if(_addOptionWithNull){if(_addOptionWithNull==1){sel.add(op,null);}
else{sel.add(op);}}
else{try{sel.add(op,null);_addOptionWithNull=1;}
catch(e){sel.add(op);_addOptionWithNull=2;}}}
function _showResizer(){if(_divProp&&_divProp.expanded){if(_resizer){var pos=JsonDataBinding.ElementPosition.getElementPosition(_divProp);_resizer.style.zIndex=JsonDataBinding.getZOrder(_divProp)+1;if(_isIE){_resizer.style.left=(pos.x+_divProp.offsetWidth-18)+'px';_resizer.style.top=(pos.y+_divProp.offsetHeight-18)+'px';}
else{_resizer.style.left=(pos.x+_divProp.offsetWidth-16)+'px';_resizer.style.top=(pos.y+_divProp.offsetHeight-16)+'px';}
_resizer.style.display='block';}
if(_nameresizer){var h0=2;var pos=JsonDataBinding.ElementPosition.getElementPosition(_tableProps);var pos2=JsonDataBinding.ElementPosition.getElementPosition(_divProp);_nameresizer.style.zIndex=JsonDataBinding.getZOrder(_tableProps)+1;if(_propsBody.rows.length>0){for(var i=0;i<_propsBody.rows.length;i++){if(_propsBody.rows[i].cells[0].colSpan!=2){_nameresizer.style.left=(pos.x+_propsBody.rows[i].cells[0].offsetWidth+1)+'px';break;}
else{h0+=_propsBody.rows[i].offsetHeight;}}}
else{_nameresizer.style.left=(pos.x+_propsBody.nameWidth)+'px';}
var top=Math.max(pos.y+h0,pos2.y);_nameresizer.style.top=top+'px';var h=pos2.y+_divProp.clientHeight-top;_nameresizer.style.height=h>0?h+'px':'16px';_nameresizer.style.display='block';}}}
function isEditorObject(c){var c0=c;while(c0){if(c0.forProperties){return true;}
c0=c0.parentNode;}
return false;}
function isEditingObject(c){if(_isEditingBody)
return true;var c0=c;while(c0){if(c0==_elementEdited){return true;}
c0=c0.parentNode;}
return false;}
function captureSelection(e){var obj=JsonDataBinding.getSender(e);if(isEditorObject(obj))
return;if(!isEditingObject(obj))
return;if(obj!=_selectedObject){selectEditElement(obj);}
if(!_selectedObject)return;if(obj==_fontCommands)return;_fontCommands.style.display='none';var textSelected;_selectedHtml=null;if(window.getSelection){_selection=window.getSelection();var isOrContainsAnchor=false;var isOrContainsFocus=false;var parentAnchor=_selection.anchorNode;var parentFocus=_selection.focusNode;while(parentAnchor&&parentAnchor!=document.documentElement){if(parentAnchor==_selectedObject){isOrContainsAnchor=true;break;}
parentAnchor=parentAnchor.parentNode;}
while(parentFocus&&parentFocus!=document.documentElement){if(parentFocus==_selectedObject){isOrContainsFocus=true;break;}
parentFocus=parentFocus.parentNode;}
if(!isOrContainsAnchor||!isOrContainsFocus){return;}
if(_selection.getRangeAt!==undefined){if(_selection.rangeCount>0){_range=_selection.getRangeAt(0);}}
else if(document.createRange&&_selection.anchorNode&&_selection.anchorOffset&&_selection.focusNode&&_selection.focusOffset){_range=document.createRange();_range.setStart(_selection.anchorNode,_selection.anchorOffset);_range.setEnd(_selection.focusNode,_selection.focusOffset);}
else{_range=null;}
var node;if(_range){if(_range.cloneContents)
_selectedHtml=_range.cloneContents().textContent;if(_range.commonAncestorContainer){if(_range.commonAncestorContainer.parentElement&&_range.commonAncestorContainer.parentElement.tagName){node=_range.commonAncestorContainer.parentElement;}
else if(_range.commonAncestorContainer.parentNode&&_range.commonAncestorContainer.parentNode.tagName){node=_range.commonAncestorContainer.parentNode;}}
else if(_range.endContainer){if(_range.endContainer.parentElement&&_range.endContainer.parentElement.tagName){node=_range.endContainer.parentElement;}
else if(_range.endContainer.parentNode&&_range.endContainer.parentNode.tagName){node=_range.endContainer.parentNode;}}
else if(_range.startContainer){if(_range.startContainer.parentElement&&_range.startContainer.parentElement.tagName){node=_range.endContainer.parentElement;}
else if(_range.startContainer.parentNode&&_range.startContainer.parentNode.tagName){node=_range.endContainer.parentNode;}}}
if(!node){if(_selection.focusNode){if(_selection.focusNode.parentElement&&_selection.focusNode.parentElement.tagName){node=_selection.focusNode.parentElement;}
else if(_selection.focusNode.parentNode&&_selection.focusNode.parentNode.tagName){node=_selection.focusNode.parentNode;}}
else if(_selection.anchorNode){if(_selection.anchorNode.parentElement&&_selection.anchorNode.parentElement.tagName){node=_selection.anchorNode.parentElement;}
else if(_selection.anchorNode.parentNode&&_selection.anchorNode.parentNode.tagName){node=_selection.anchorNode.parentNode;}}}
if(node){if(isEditorObject(node))
return;if(!isEditingObject(node))
return;if(node!=_selectedObject){selectEditElement(node);}
textSelected=_selection.toString();}}
else if(document.selection&&document.selection.createRange){_range=document.selection.createRange();textSelected=_range.text;if(_range.htmlText){_selectedHtml=_range.htmlText;}
else if(_range.length>0){_selectedHtml=_range.item(0).outerHTML;}
if(_range.parentElement){var node=_range.parentElement();if(node){if(!isEditorObject(node)&&isEditingObject(node)){if(node!=_selectedObject){selectEditElement(node);}}}}}
if(textSelected){if(textSelected.length>0){showFontCommands();}}}
function showFontCommands(){_fontCommands.style.display='inline';var imgs=_fontCommands.getElementsByTagName('img');for(var i=0;i<imgs.length;i++){if(document.queryCommandState(imgs[i].cmd)){imgs[i].src=imgs[i].actSrc;}
else{imgs[i].src=imgs[i].inactSrc;}}}
function createElement(tagname,type){for(var k=0;k<_elementEditorList.length;k++){if(_elementEditorList[k].tagname==tagname){if(_elementEditorList[k].type){if(_elementEditorList[k].type==type){return _elementEditorList[k].creator();break;}}
else if(_elementEditorList[k].creator){return _elementEditorList[k].creator();break;}}}
return document.createElement(tagname);}
function _addCommandList(commands){if(_commandList){if(commands){for(var i=0;i<commands.length;i++){for(var k=0;k<_commandList.length;k++){if(_commandList[k].cmd==commands[i].cmd){_commandList.slice(k,1);break;}}}
for(var i=0;i<commands.length;i++){_commandList.push(commands[i]);}}}
else{_commandList=commands;}}
function _addAddableElementList(addables){if(_addableElementList){if(addables){for(var i=0;i<addables.length;i++){for(var k=0;k<_addableElementList.length;k++){if(_addableElementList[k].tag==addables[i].tag){if(addables[i].type){if(addables[i].type==_addableElementList[k].type){_addableElementList.slice(k,1);break;}}
else{_addableElementList.slice(k,1);break;}}}}
for(var i=0;i<addables.length;i++){_addableElementList.push(addables[i]);}}}
else{_addableElementList=addables;}}
function _addEditors(editors){if(_elementEditorList){if(editors){for(var i=0;i<editors.length;i++){for(var k=0;k<_elementEditorList.length;k++){if(_elementEditorList[k].tagname==editors[i].tagname){_elementEditorList.slice(k,1);break;}}}
for(var i=0;i<editors.length;i++){_elementEditorList.push(editors[i]);}}}
else{_elementEditorList=editors;}}
function hideSelector(){if(_divSelectElement){_divSelectElement.style.display='none';}
_showResizer();}
function insertNodeOverSelection(node,tagname){if(tagname=='area'){var map=_selectedObject;while(map){if(map.tagName&&map.tagName.toLowerCase()=='map')
break;map=map.parentNode;}
if(map){map.appendChild(node);selectEditElement(node);}}
else{if(window.getSelection){if(_range){if(tagname=='font'||tagname=='a'){if(_selectedHtml)
node.innerHTML=_selectedHtml;}
if(isOrContainsNode(_selectedObject,_range.commonAncestorContainer)){_range.deleteContents();_range.insertNode(node);}
else{_selectedObject.appendChild(node);}
if(node.focus)
node.focus();selectEditElement(node);}}
else{if(_range){if(isOrContainsNode(_selectedObject,_range.parentElement())){if(tagname=='font'||tagname=='a'){if(_selectedHtml)
node.innerHTML=_selectedHtml;else
node.innerHTML=_range.text;}
var id='v'+Math.floor(Math.random()*65536);node.id=id;var html=(node.nodeType==3)?node.data:node.outerHTML;_range.pasteHTML(html);node=document.getElementById(id);if(node){if(node.focus)
node.focus();node.id='';selectEditElement(node);}}
else{_selectedObject.appendChild(node);selectEditElement(node);}}}}}
function isOrContainsNode(ancestor,descendant){var node=descendant;while(node){if(node===ancestor)
return true;node=node.parentNode;}
return false;}
function createElementSelector(){_divSelectElement.style.position='absolute';_divSelectElement.style.display='none';_divSelectElement.contentEditable=false;_divSelectElement.forProperties=true;var rn=Math.floor(Math.sqrt(_addableElementList.length));var rC=rn+3;var tC=Math.floor(_addableElementList.length/rC);while(rC*tC<_addableElementList.length){tC++;}
var tbls=document.createElement('table');tbls.border=0;tbls.cellPadding=0;tbls.cellSpacing=0;_divSelectElement.appendChild(tbls);var tbody0=JsonDataBinding.getTableBody(tbls);var tr0=tbody0.insertRow(-1);var ci=0;for(var ti=0;ti<tC;ti++){var td0=document.createElement('td');td0.style.verticalAlign='top';tr0.appendChild(td0);var tblSel=document.createElement('table');tblSel.style.verticalAlign='top';td0.appendChild(tblSel);tblSel.border=1;tblSel.bgColor=_newElementSelectTableBackColor;tblSel.style.cursor='pointer';var tbody=JsonDataBinding.getTableBody(tblSel);for(var i=0;i<rC;i++){var tr=tbody.insertRow(-1);tr.elementTag=_addableElementList[ci].tag;if(_addableElementList[ci].type){tr.type=_addableElementList[ci].type;}
var td=document.createElement('td');tr.appendChild(td);var img=document.createElement('img');img.src=_addableElementList[ci].image;img.style.display='inline';td.appendChild(img);td=document.createElement('td');tr.appendChild(td);td.innerHTML=_addableElementList[ci].name;JsonDataBinding.AttachEvent(tr,'onmouseover',onhsMouseOver);JsonDataBinding.AttachEvent(tr,'onmouseout',onhsMouseOut);JsonDataBinding.AttachEvent(tr,'onclick',onhsMouseClick);ci++;if(ci>=_addableElementList.length)break;}}
function restoreBackColor(cells){var bkc=_newElementSelectTableBackColor;for(var c=0;c<cells.length;c++){if(cells[c].isMouseOver){cells[c].style.backgroundColor='#ffffc0';}
else{cells[c].style.backgroundColor=bkc;}}}
function onhsMouseClick(e){var cell=JsonDataBinding.getSender(e);;if(cell){var tr=cell.parentNode;while(tr&&tr.tagName&&tr.tagName.toLowerCase()!='tr'){tr=tr.parentNode;}
if(tr){hideSelector();if(_isEditingBody){document.body.contentEditable=true;}
if(tr.elementTag&&_selectedObject){var newElement=createElement(tr.elementTag,tr.type);insertNodeOverSelection(newElement,tr.elementTag);}}}}
function onhsMouseOver(e){var cell=JsonDataBinding.getSender(e);;if(cell){var tbl=cell.parentNode;while(tbl&&tbl.tagName.toLowerCase()!='table'){tbl=tbl.parentNode;}
var cells=tbl.getElementsByTagName("td");for(var i=0;i<cells.length;i++){cells[i].isMouseOver=false;}
cell.isMouseOver=true;restoreBackColor(cells);}}
function onhsMouseOut(e){var cell=JsonDataBinding.getSender(e);if(cell){var tbl=cell.parentNode;while(tbl&&tbl.tagName.toLowerCase()!='table'){tbl=tbl.parentNode;}
var cells=tbl.getElementsByTagName("td");cell.isMouseOver=false;restoreBackColor(cells);}}
function _getSelectedElement(){}
return{getSelectedElement:function(){return _getSelectedElement();}};}
function selectparent(){if(_parentList.selectedIndex>=0&&_parentList.selectedIndex<_parentList.options.length){var obj=_parentList.options[_parentList.selectedIndex].objvalue;showProperties(obj);}}
function finshiEdit(){if(_finishHandler){_getresultHTML();var html=_resultHtml;_finishHandler(html,_saveToFolder?_saveToFolder:'',_saveTo?_saveTo:'');HtmlEditor.isEditing=false;}}
function createTable(){var tbl=document.createElement('table');tbl.border=1;var h=document.createElement('thead');tbl.appendChild(h);var r=document.createElement('tr');h.appendChild(r);var c=document.createElement('td');r.appendChild(c);c.innerHTML='column 1';c=document.createElement('td');r.appendChild(c);c.innerHTML='column 2';var tbody=JsonDataBinding.getTableBody(tbl);r=document.createElement('tr');tbody.appendChild(r);c=document.createElement('td');r.appendChild(c);c.innerHTML='row 1, cell 1';c=document.createElement('td');r.appendChild(c);c.innerHTML='row 1 cell 2';r=document.createElement('tr');tbody.appendChild(r);c=document.createElement('td');r.appendChild(c);c.innerHTML='row 2, cell 1';c=document.createElement('td');r.appendChild(c);c.innerHTML='row 2 cell 2';return tbl;}
function addElement(e){var sender=JsonDataBinding.getSender(e);if(sender&&_selectedObject){var ap=JsonDataBinding.ElementPosition.getElementPosition(sender);if(ap){document.body.contentEditable=false;ap.x+=document.body.scrollLeft;ap.y+=document.body.scrollTop;if(ap.x<0)ap.x=0;if(ap.y<0)ap.y=0;_divSelectElement.style.left=(ap.x+3)+'px';_divSelectElement.style.top=(ap.y+3)+'px';_divSelectElement.style.zIndex=JsonDataBinding.getZOrder(sender)+1;_divSelectElement.style.display='block';document.body.contentEditable=false;_nameresizer.style.display='none';JsonDataBinding.windowTools.updateDimensions();ps=JsonDataBinding.ElementPosition.getElementPosition(_divSelectElement);var pw=JsonDataBinding.windowTools.windowSize.windowWidth;var ph=JsonDataBinding.windowTools.windowSize.windowHeight;if(ps.x+_divSelectElement.scrollWidth>pw-20){var x;x=pw-_divSelectElement.offsetWidth+document.body.scrollLeft-20;if(x<0)x=0;_divSelectElement.style.left=x+'px';}
if(ps.y+_divSelectElement.scrollHeight>ph-20){var y;y=ph-_divSelectElement.offsetHeight+document.body.scrollTop-20;if(y<0){y=0;alert('y');}
_divSelectElement.style.top=y+'px';}}}}
function onFontSelected(e){if(_fontSelect.selectedIndex>=0){var fi=_fontSelect.options[_fontSelect.selectedIndex];var fn=document.createElement('font');fn.style.fontFamily=fi.value;insertNodeOverSelection(fn,'font');}}
function fontCommandSelected(e){var c=JsonDataBinding.getSender(e);if(c&&c.cmd){if(typeof c.useUI!='undefined'){if(typeof c.value!='undefined'){document.execCommand(c.cmd,c.useUI,c.value);}
else{document.execCommand(c.cmd,c.useUI);}}
else{if(c.cmd=='createlink'){if(_isIE){document.execCommand(c.cmd);}
else{var a=document.createElement('a');insertNodeOverSelection(a,'a');}}
else{if(_isFireFox){document.execCommand(c.cmd,null,false);}
else{if(_isOpera){if(_selectedObject)_selectedObject.contentEditable=true;}
document.execCommand(c.cmd);}}}
if(!_isFireFox){if(document.queryCommandState(c.cmd)){c.src=c.actSrc;}
else{c.src=c.inactSrc;}}}}
function refreshProperties(){if(_selectedObject){var c=_selectedObject;_selectedObject=null;selectEditElement(c);}}
function stripTag(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var node=c.owner;var parent=node.parentNode;while(node.firstChild){parent.insertBefore(node.firstChild,node);}
parent.removeChild(node);selectEditElement(parent);}}
function gotoChildByTag(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner&&c.propDesc){var node=c.owner;var cs=node.getElementsByTagName(c.propDesc.name);var c;if(cs&&cs.length>0){c=cs[0];}
else{if(!c.propDesc.notcreate){c=document.createElement(c.propDesc.name);node.appendChild(c);}}
selectEditElement(c);}}
function moveOutTag(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var node=c.owner;var parent=node.parentNode;if(parent!=document.body){var p=parent.parentNode;if(p){parent.removeChild(node);p.insertBefore(node,parent.nextSibling);_selectedObject=null;selectEditElement(node);}}}}
function getContainer(obj){var p=obj.parentNode;if(obj.tagName){var tn=obj.tagName.toLowerCase();if(tn=='td'||tn=='tr'||tn=='th'){while(p){if(p.tagName){tn=p.tagName.toLowerCase();if(tn=='table'){return p;}}
p=p.parentNode;}}
if(p.tagName){tn=p.tagName.toLowerCase();while(tn=='p'&&p){p=p.parentNode;if(p.tagName){tn=p.tagName.toLowerCase();}}}}
return p;}
function getObjectAbsoluteLocation(obj){if(obj&&obj.style){if(obj.style.position=='absolute'){return{x:obj.offsetLeft,y:obj.offsetTop};}
else{var objP=getContainer(obj);if(objP){var p=getObjectAbsoluteLocation(objP);if(p){return{x:obj.offsetLeft+p.x,y:obj.offsetTop+p.y};}
else{return{x:obj.offsetLeft,y:obj.offsetTop};}}
else{return{x:obj.offsetLeft,y:obj.offsetTop};}}}}
function showSelectionMark(obj){var ap=JsonDataBinding.ElementPosition.getElementPosition(obj);if(ap){_redbox.style.left=ap.x+'px';_redbox.style.top=ap.y+'px';_redbox.style.display='block';_redbox.style.zIndex=1000;}
_parentList.options.length=0;var tab='';var p=obj;while(p){if(p.tagName){var item=document.createElement('option');var txt=tab+p.tagName;if(p.id){txt=txt+'('+p.id+') ';}
if(p.name){txt=txt+p.name;}
item.text=txt;item.objvalue=p;item.selected=false;addOptionToSelect(_parentList,item);item.selected=false;tab+='..';}
p=p.parentNode;}
_parentList.size=_parentList.options.length;_parentList.selectedIndex=-1;for(var i=0;i<_parentList.options.length;i++){_parentList.options[i].selected=false;}}
function getColumnCount(rowHolder){var cn=0;if(rowHolder.rows.length>0){for(var c=0;c<rowHolder.rows[0].cells.length;c++){cn+=rowHolder.rows[0].cells[c].colSpan?rowHolder.rows[0].cells[c].colSpan:1;}}
return cn;}
function getRowCount(rowHolder){return rowHolder.rows.length;}
function mapGridColumnIndexToTableCellIndex(gridCellIndex,row){var ci=0;for(var c=0;c<row.cells.length;c++){ci+=row.cells[c].colSpan?row.cells[c].colSpan:1;if(ci>gridCellIndex){return c;}}
return-1;}
function getVirtualColumnIndex(td,maprow){for(var c=0;c<maprow.length;c++){if(maprow[c]==td){return c;}}
return-1;}
function getNextVirtualColumnIndex(td,maprow){var f;for(var c=0;c<maprow.length;c++){if(f){if(maprow[c]!=td){return c;}}
else if(maprow[c]==td){f=true;}}
return-1;}
function getVirtualRow(td,vrCount,vcCount){var tds=new Array();var row=td.parentNode;var rowHolder;if(row){rowHolder=row.parentNode;}
if(rowHolder){var ri=getRowIndex(row);if(!vrCount)vrCount=getRowCount(rowHolder);if(!vcCount)vcCount=getColumnCount(rowHolder);for(var ci=0;ci<vcCount;ci++){var rSum=0;for(var r=0;r<vrCount;r++){rSum+=rowHolder.rows[r].cells[ci].rowSpan?rowHolder.rows[r].cells[ci].rowSpan:1;if(rSum>=ri){tds.pus(rowHolder.rows[r].cells[ci]);if(rowHolder.rows[r].cells[ci].colSpan>1){ci+=(rowHolder.rows[r].cells[ci].colSpan-1);}
break;}
if(rowHolder.rows[r].cells[ci].rowSpan>1){r+=(rowHolder.rows[r].cells[ci].rowSpan-1);}}}}
return tds;}
function _getTableMap(rowHolder){var vrCount=getRowCount(rowHolder);var vcCount=getColumnCount(rowHolder);var vcells=new Array();for(var r=0;r<vrCount;r++){vcells[r]=new Array(vcCount);for(var c=0;c<vcCount;c++){vcells[r][c]=null;}}
for(var r=0;r<rowHolder.rows.length;r++){var ci=0;for(var c=0;c<rowHolder.rows[r].cells.length;c++){var cr=rowHolder.rows[r].cells[c].colSpan?rowHolder.rows[r].cells[c].colSpan:1;var rr=rowHolder.rows[r].cells[c].rowSpan?rowHolder.rows[r].cells[c].rowSpan:1;while(vcells[r][ci]!=null){ci++;}
for(var i=ci;i<ci+cr;i++){for(var j=r;j<r+rr;j++){vcells[j][i]=rowHolder.rows[r].cells[c];}}
ci+=cr;}}
return vcells;}
function getVirtualColumn(td,vrCount,vcCount){var tds=new Array();var row=td.parentNode;var rowHolder;if(row){rowHolder=row.parentNode;}
if(rowHolder){var ridx=getRowIndex(row);if(!vrCount)vrCount=getRowCount(rowHolder);if(!vcCount)vcCount=getColumnCount(rowHolder);var vcells=new Array();for(var r=0;r<vrCount;r++){vcells[r]=new Array(vcCount);for(var c=0;c<vcCount;c++){vcells[r][c]=null;}}
var ri=0;for(var r=0;r<vrCount;r++){var ci=0;for(var c=0;c<rowHolder.rows[r].cells.length;c++){var cr=rowHolder.rows[r].cells[c].colSpan?rowHolder.rows[r].cells[c].colSpan:1;var rr=rowHolder.rows[r].cells[c].rowSpan?rowHolder.rows[r].cells[c].rowSpan:1;while(vcells[r][ci]!=null){ci++;}
for(var i=ci;i<ci+cr;i++){for(var j=r;j<r+rr;j++){vcells[j][i]=cr;}}
ci+=cr;}}
for(var r=0;r<vrCount;r++){var cSum=0;for(var ci=0;ci<vcCount;ci++){cSum+=rowHolder.rows[r].cells[ci].colSpan?rowHolder.rows[r].cells[ci].colSpan:1;if(cSum>=ridx){tds.pus(rowHolder.rows[r].cells[ci]);if(rowHolder.rows[r].cells[ci].colSpan>1){ci+=(rowHolder.rows[r].cells[ci].colSpan-1);}
break;}
if(rowHolder.rows[r].cells[ci].rowSpan>1){r+=(rowHolder.rows[r].cells[ci].rowSpan-1);}}}}
return tds;}
function getTDbyVirtualPosition(rowHolder,vr,vc,vrCount,vcCount){if(!vrCount)vrCount=getRowCount(rowHolder);if(!vcCount)vcCount=getColumnCount(rowHolder);if(vrCount>0&&vcCount>0){var vrc=0;for(var r=0;r<vrCount;r++){if(rowHolder.rows[r].cells.length>0){vrc+=rowHolder.rows[r].cells[0].rowSpan?rowHolder.rows[r].cells[0].rowSpan:1;}
else{vrc+=1;}
if(vrc>=vr){var row=rowHolder.rows[r];var vcc=0;for(var c=0;c<row.cells.length;c++){vcc+=row.cells[c].colSpan?row.cells[c].colSpan:1;if(vcc>=vc){return row.cells[c];}}}}}
return null;}
function _togglePropertiesWindow(){if(_divProp.expanded){_divProp.fullHeight=_divProp.style.height;_tableProps.style.display='none';_editorTable.style.display='none';if(_divSelectElement){hideSelector();}
_divProp.style.height=(_titleTable.offsetHeight)+'px';_resizer.style.display='none';_nameresizer.style.display='none';}
else{_divProp.style.height=_divProp.fullHeight;_tableProps.style.display='block';_editorTable.style.display='block';}
_divProp.expanded=!_divProp.expanded;_showResizer();}
var EDIT_NONE=0;var EDIT_TEXT=1;var EDIT_NUM=2;var EDIT_BOOL=3;var EDIT_COLOR=4;var EDIT_ENUM=5;var EDIT_PARENT=6;var EDIT_CMD=7;var EDIT_CHILD=8;var EDIT_PROPS=9;var EDIT_CMD2=10;var EDIT_CMD3=11;var EDIT_MENUM=12;var EDIT_DEL=13;var EDIT_NODES=14;var EDIT_GO=15;function _showEditor(display){_divProp.style.display=display;}
function onselChangeForProperties(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner&&c.selectedIndex>=0){var op=c.owner.options[c.selectedIndex];if(op){selectEditElement(op);}}}
function showListItems(sel,trCmd){if(_isFireFox||_isOpera)return;var op0;while(sel){if(sel.tagName){if(sel.tagName.toLowerCase()=='option'){op0=sel;}
else if(sel.tagName.toLowerCase()=='select'){break;}}
sel=sel.parentNode;}
if(sel){var sel2=document.createElement('select');sel2.size=1;trCmd.appendChild(sel2);var selIdx=-1;for(var i=0;i<sel.options.length;i++){var op=document.createElement('option');op.text=sel.options[i].text;if(sel.options[i]==op0){op.selected=false;}
addOptionToSelect(sel2,op);}
sel2.owner=sel;sel2.selectedIndex=selIdx;JsonDataBinding.AttachEvent(sel2,"onchange",onselChangeForProperties);}}
function deleteElement(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var p=c.owner.parentNode;if(p){p.removeChild(c.owner);selectEditElement(p);}}}
function gotoElement(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){selectEditElement(c.owner);}}
function addmeta(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var head=c.owner;var m=document.createElement('meta');head.appendChild(m);selectEditElement(m);}}
function addlink(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var head=c.owner;var m=document.createElement('link');head.appendChild(m);selectEditElement(m);}}
function addscript(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var head=c.owner;var m=document.createElement('script');head.appendChild(m);selectEditElement(m);}}
function addOptionGroup(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var sel=c.owner;while(sel){if(sel.tagName){if(sel.tagName.toLowerCase()=='select'){break;}}
sel=sel.parentNode;}
if(sel){var op=document.createElement('optgroup');op.label='option group';sel.appendChild(op);selectEditElement(op);}}}
function addOption(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var sel=c.owner;var og;while(sel){if(sel.tagName){if(sel.tagName.toLowerCase()=='select'){break;}
if(sel.tagName.toLowerCase()=='optgroup'){og=sel;break;}}
sel=sel.parentNode;}
if(sel||og){var op=document.createElement('option');if(sel.options)
op.innerHTML='new option '+sel.options.length;else
op.innerHTML='new option 0';if(og){og.appendChild(op);}
else{addOptionToSelect(sel,op);}
selectEditElement(op);}}}
function addDefinition(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var dl=c.owner;var dt=document.createElement('dt');dt.innerHTML='new definition';dl.appendChild(dt);var dd=document.createElement('dd');dd.innerHTML='new description';dl.appendChild(dd);}}
function addObjectParameter(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var obj=c.owner;var pa=document.createElement('param');var nm='p'+Math.floor(Math.random()*65536);pa.name=nm;pa.id=nm;obj.appendChild(pa);selectEditElement(pa);}}
function addtheader(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var tbl=c.owner;var h;var hs=tbl.getElementsByTagName('thead');if(hs&&hs.length>0){h=hs[0];}
else{var cells;var tbd=JsonDataBinding.getTableBody(tbl);if(tbd&&tbd.rows&&tbd.rows.length>0){cells=tbd.rows[0].cells;}
h=document.createElement('thead');tbl.appendChild(h);var tr=document.createElement('tr');h.appendChild(tr);if(cells){for(var c=0;c<cells.length;c++){var th=document.createElement('th');th.innerHTML="Column "+(c+1);th.colSpan=cells[c].colSpan;tr.appendChild(th);}}}
selectEditElement(h);}}
function addtfooter(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var tbl=c.owner;var h;var hs=tbl.getElementsByTagName('tfoot');if(hs&&hs.length>0){h=hs[0];}
else{var cells;var tbd=JsonDataBinding.getTableBody(tbl);if(tbd&&tbd.rows&&tbd.rows.length>0){cells=tbd.rows[tbd.rows.length-1].cells;}
h=document.createElement('tfoot');tbl.appendChild(h);var tr=document.createElement('tr');h.appendChild(tr);var tbd=JsonDataBinding.getTableBody(tbl);if(cells){for(var c=0;c<cells.length;c++){var th=document.createElement('th');th.innerHTML="Column "+(c+1);th.colSpan=cells[c].colSpan;tr.appendChild(th);}}}
selectEditElement(h);}}
function addMapArea(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var map=c.owner;var area=document.createElement('area');map.appendChild(area);selectEditElement(area);}}
function addLegend(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var fs=c.owner;var lg;var lgs=fs.getElementsByTagName('legend');if(lgs&&lgs.length>0){lg=lgs[0];if(!lg.innerHTML||lg.innerHTML.length==0){lg.innerHTML='<b>group</b>';}}
else{lg=document.createElement('legend');lg.innerHTML='<b>group</b>';fs.appendChild(lg);}
selectEditElement(lg);}}
function isSameColSpan(td1,td2){if(td1.colSpan&&td2.colSpan){return(td1.colSpan==td2.colSpan);}
if(!td1.colSpan&&!td2.colSpan){return true;}
return false;}
function isSameRowSpan(td1,td2){if(td1.rowSpan&&td2.rowSpan){return(td1.rowSpan==td2.rowSpan);}
if(!td1.rowSpan&&!td2.rowSpan){return true;}
return false;}
function getRowIndex(row){var ri=row.rowIndex;if(row.parentNode&&row.parentNode.tagName){var tag=row.parentNode.tagName.toLowerCase();if(tag=='thead'){return ri;}
var tbl=row.parentNode.parentNode;if(tbl){var hs=tbl.getElementsByTagName('thead');if(hs&&hs.length>0){for(var h=0;h<hs.length;h++){ri-=hs[h].rows.length;}}
if(tag=='tbody'){return ri;}
if(tag=='tfoot'){hs=tbl.getElementsByTagName('tbody');if(hs&&hs.length>0){for(var h=0;h<hs.length;h++){ri-=hs[h].rows.length;}}}}}
return ri;}
function addRowAbove(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var td=c.owner;var row;if(td.cells){row=td;}
else{row=td.parentNode;}
if(row&&row.parentNode){var rowParent=row.parentNode;var rIndex=getRowIndex(row);var map=_getTableMap(rowParent);var nr=rowParent.insertRow(rIndex);var lastTD=null;for(var i=0;i<map[rIndex].length;i++){if(map[rIndex][i]!=lastTD){lastTD=map[rIndex][i];var isCross=false;if(rIndex>0&&rIndex<map.length){if(map[rIndex][i]==map[rIndex-1][i]){isCross=true;}}
if(isCross){map[rIndex][i].rowSpan=map[rIndex][i].rowSpan+1;}
else{var tdn=document.createElement("td");tdn.innerHTML="&nbsp";tdn.colSpan=map[rIndex][i].colSpan;tdn.bgColor=map[rIndex][i].bgColor;nr.appendChild(tdn);}}}
showSelectionMark(_selectedObject);}}}
function addRowBelow(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var td=c.owner;var row;if(td.cells){row=td;}
else{row=td.parentNode;}
if(row&&row.parentNode){var rowParent=row.parentNode;var rIndex=getRowIndex(row);var map=_getTableMap(rowParent);var nr=rowParent.insertRow(rIndex+1);var lastTD=null;for(var i=0;i<map[rIndex].length;i++){if(map[rIndex][i]!=lastTD){lastTD=map[rIndex][i];var isCross=false;if(rIndex>=0&&rIndex<map.length-1){if(map[rIndex][i]==map[rIndex+1][i]){isCross=true;}}
if(isCross){map[rIndex][i].rowSpan=map[rIndex][i].rowSpan+1;}
else{var tdn=document.createElement("td");tdn.innerHTML="&nbsp";tdn.colSpan=map[rIndex][i].colSpan;tdn.bgColor=map[rIndex][i].bgColor;nr.appendChild(tdn);}}}
showSelectionMark(_selectedObject);}}}
function addColumnToLeft(holder,map,colIdx){var lastTD=null;for(var r=0;r<map.length;r++){if(map[r][colIdx]!=lastTD){lastTD=map[r][colIdx];var isCross=false;if(colIdx>0&&colIdx<map[r].length-1){if(map[r][colIdx]==map[r][colIdx-1]){if(map[r][colIdx]==map[r][colIdx+1]){isCross=true;}}}
if(isCross){map[r][colIdx].colSpan=(map[r][colIdx].colSpan?map[r][colIdx].colSpan:0)+1;}
else{var cidx=mapGridColumnIndexToTableCellIndex(colIdx,holder.rows[r]);var tdn=holder.rows[r].insertCell(cidx);tdn.innerHTML="&nbsp";tdn.rowSpan=map[r][colIdx].rowSpan;tdn.bgColor=map[r][colIdx].bgColor;}}}}
function addColumnLeft(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var td=c.owner;if(td.parentNode&&td.parentNode.parentNode){var row=td.parentNode;var rowParent=row.parentNode;var ri=getRowIndex(row);var map=_getTableMap(rowParent);var colIdx=getVirtualColumnIndex(td,map[ri]);addColumnToLeft(rowParent,map,colIdx);var tbl=rowParent;while(tbl.tagName){if(tbl.tagName.toLowerCase()=='table'){break;}
tbl=tbl.parentNode;}
var holders=tbl.getElementsByTagName('tbody');if(holders&&holders.length>0){for(var i=0;i<holders.length;i++){if(holders[i]!=rowParent){map=_getTableMap(holders[i]);addColumnToLeft(holders[i],map,colIdx);}}}
holders=tbl.getElementsByTagName('thead');if(holders&&holders.length>0){for(var i=0;i<holders.length;i++){if(holders[i]!=rowParent){map=_getTableMap(holders[i]);addColumnToLeft(holders[i],map,colIdx);}}}
holders=tbl.getElementsByTagName('tfoot');if(holders&&holders.length>0){for(var i=0;i<holders.length;i++){if(holders[i]!=rowParent){map=_getTableMap(holders[i]);addColumnToLeft(holders[i],map,colIdx);}}}
showSelectionMark(_selectedObject);}}}
function addColumnToRight(holder,map,colIdx){var lastTD=null;for(var r=0;r<map.length;r++){if(map[r][colIdx]!=lastTD){lastTD=map[r][colIdx];var isCross=false;if(colIdx>0&&colIdx<map[r].length-1){if(map[r][colIdx]==map[r][colIdx-1]){if(map[r][colIdx]==map[r][colIdx+1]){isCross=true;}}}
if(isCross){map[r][colIdx].colSpan=map[r][colIdx].colSpan+1;}
else{var tn=map[r][colIdx];var tnci=tn.cellIndex?tn.cellIndex:0;var tdn=tn.parentNode.insertCell(tnci+1);tdn.innerHTML="&nbsp";tdn.rowSpan=tn.rowSpan;tdn.bgColor=tn.bgColor;}}}}
function addColumnRight(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var td=c.owner;if(td.parentNode&&td.parentNode.parentNode){var row=td.parentNode;var rowParent=row.parentNode;var ri=getRowIndex(row);var map=_getTableMap(rowParent);var colIdx=getVirtualColumnIndex(td,map[ri]);addColumnToRight(rowParent,map,colIdx);var tbl=rowParent;while(tbl.tagName){if(tbl.tagName.toLowerCase()=='table'){break;}
tbl=tbl.parentNode;}
var holders=tbl.getElementsByTagName('tbody');if(holders&&holders.length>0){for(var i=0;i<holders.length;i++){if(holders[i]!=rowParent){map=_getTableMap(holders[i]);addColumnToRight(holders[i],map,colIdx);}}}
holders=tbl.getElementsByTagName('thead');if(holders&&holders.length>0){for(var i=0;i<holders.length;i++){if(holders[i]!=rowParent){map=_getTableMap(holders[i]);addColumnToRight(holders[i],map,colIdx);}}}
holders=tbl.getElementsByTagName('tfoot');if(holders&&holders.length>0){for(var i=0;i<holders.length;i++){if(holders[i]!=rowParent){map=_getTableMap(holders[i]);addColumnToRight(holders[i],map,colIdx);}}}
showSelectionMark(_selectedObject);}}}
function mergeColumnLeft(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var td=c.owner;if(td.parentNode&&td.parentNode.parentNode){var row=td.parentNode;var colIdx=td.cellIndex?td.cellIndex:0;if(colIdx>0){var canMerge=true;var rIndex=getRowIndex(row);var rowParent=row.parentNode;var td0=row.cells[colIdx-1];var map=_getTableMap(rowParent);var vci=getVirtualColumnIndex(td,map[rIndex]);if(rIndex>0&&map[rIndex][vci-1]==map[rIndex-1][vci-1]){canMerge=false;}
else if(map[rIndex][vci-1].rowSpan!=map[rIndex][vci].rowSpan){canMerge=false;}
if(canMerge){var cp=td.colSpan?td.colSpan:1;var hl=td.innerHTML;row.deleteCell(colIdx);td0.colSpan=cp+(td0.colSpan?td0.colSpan:1);td0.innerHTML=td0.innerHTML+hl;docClick({target:td0});showSelectionMark(td0);}}}}}
function mergeColumnRight(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var td=c.owner;if(td.parentNode&&td.parentNode.parentNode){var row=td.parentNode;var colIdx=td.cellIndex?td.cellIndex:0;if(colIdx>=0&&colIdx<row.cells.length-1){var canMerge=true;var rIndex=getRowIndex(row);var rowParent=row.parentNode;var map=_getTableMap(rowParent);var cidx=getVirtualColumnIndex(td,map[rIndex]);var nextcidx=getNextVirtualColumnIndex(td,map[rIndex]);if(nextcidx<0){canMerge=false;}
else if(rIndex>0&&map[rIndex][nextcidx]==map[rIndex-1][nextcidx]){canMerge=false;}
else{if(!isSameRowSpan(map[rIndex][nextcidx],map[rIndex][cidx])){canMerge=false;}}
if(canMerge){var td1=row.cells[colIdx+1];if(td.colSpan){td.colSpan=td1.colSpan+td.colSpan;}
else{td.colSpan=td1.colSpan+1;}
td.innerHTML=td.innerHTML+td1.innerHTML;row.deleteCell(colIdx+1);docClick({target:td});}}}}}
function mergeColumnAbove(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var td=c.owner;if(td.parentNode&&td.parentNode.parentNode){var row=td.parentNode;var rowParent=row.parentNode;var colIdx=td.cellIndex?td.cellIndex:0;var rowIndex=getRowIndex(row);if(colIdx>=0&&colIdx<row.cells.length&&rowIndex>0&&rowIndex<rowParent.rows.length){var canMerge=true;var map=_getTableMap(rowParent);var cvi=getVirtualColumnIndex(td,map[rowIndex]);if(cvi>=0){if(cvi>0&&map[rowIndex-1][cvi-1]==map[rowIndex-1][cvi]){canMerge=false;}
else if(!isSameColSpan(map[rowIndex-1][cvi],map[rowIndex][cvi])){canMerge=false;}
if(canMerge){var td0=map[rowIndex-1][cvi];if(td0.colSpan==td.colSpan){td0.rowSpan=td0.rowSpan+td.rowSpan;td0.innerHTML=td0.innerHTML+td.innerHTML;row.deleteCell(colIdx);docClick({target:td0});}}}}}}}
function mergeColumnBelow(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var td=c.owner;if(td.parentNode&&td.parentNode.parentNode){var row=td.parentNode;var rowParent=row.parentNode;var colIdx=td.cellIndex?td.cellIndex:0;var rowIndex=getRowIndex(row);if(colIdx>=0&&colIdx<row.cells.length&&rowIndex>=0&&rowIndex<rowParent.rows.length-1){var canMerge=true;var map=_getTableMap(rowParent);var cvi=getVirtualColumnIndex(td,map[rowIndex]);var n=1;var td1=map[rowIndex+n][cvi];while(td1==td){n++;if(n+rowIndex>=map.length){canMerge=false;break;}
td1=map[rowIndex+n][cvi];}
if(canMerge){if(td==td1){canMerge=false;}
else{if(!isSameColSpan(td1,td)){canMerge=false;}}}
if(canMerge){var sp=td1.rowSpan?td1.rowSpan:1;var hl=td1.innerHTML;var c1=td1.cellIndex?td1.cellIndex:0;td1.parentNode.deleteCell(c1);td.rowSpan=(td.rowSpan?td.rowSpan:1)+sp;td.innerHTML=td.innerHTML+hl;docClick({target:td});}}}}}
function splitColumnH(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var td=c.owner;if(td.parentNode&&td.parentNode.parentNode){var row=td.parentNode;var colIdx=td.cellIndex?td.cellIndex:0;if(colIdx>=0&&colIdx<row.cells.length){if(td.colSpan>1){var tdn=row.insertCell(colIdx+1);tdn.innerHTML="&nbsp";td.colSpan=td.colSpan-1;tdn.rowSpan=td.rowSpan;}
else{var rowParent=row.parentNode;var rowIndex=getRowIndex(row);var map=_getTableMap(rowParent);var vci=getVirtualColumnIndex(td,map[rowIndex]);var lastTD=null;for(var r=0;r<map.length;r++){if(map[r][vci]!=lastTD){lastTD=map[r][vci];if(lastTD==td){var tdn=row.insertCell(colIdx+1);tdn.innerHTML="&nbsp";tdn.rowSpan=td.rowSpan;}
else{lastTD.colSpan=(lastTD.colSpan?lastTD.colSpan:1)+1;}}}
var tbl=rowParent;while(tbl.tagName){if(tbl.tagName.toLowerCase()=='table'){break;}
tbl=tbl.parentNode;}
var holders=tbl.getElementsByTagName('tbody');if(holders&&holders.length>0){for(var i=0;i<holders.length;i++){if(holders[i]!=rowParent){map=_getTableMap(holders[i]);lastTD=null;for(var r=0;r<map.length;r++){if(map[r][vci]!=lastTD){lastTD=map[r][vci];lastTD.colSpan=(lastTD.colSpan?lastTD.colSpan:1)+1;}}}}}
holders=tbl.getElementsByTagName('thead');if(holders&&holders.length>0){for(var i=0;i<holders.length;i++){if(holders[i]!=rowParent){map=_getTableMap(holders[i]);lastTD=null;for(var r=0;r<map.length;r++){if(map[r][vci]!=lastTD){lastTD=map[r][vci];lastTD.colSpan=(lastTD.colSpan?lastTD.colSpan:1)+1;}}}}}
holders=tbl.getElementsByTagName('tfoot');if(holders&&holders.length>0){for(var i=0;i<holders.length;i++){if(holders[i]!=rowParent){map=_getTableMap(holders[i]);lastTD=null;for(var r=0;r<map.length;r++){if(map[r][vci]!=lastTD){lastTD=map[r][vci];lastTD.colSpan=(lastTD.colSpan?lastTD.colSpan:1)+1;}}}}}}
showSelectionMark(_selectedObject);}}}}
function splitColumnV(e){var c=JsonDataBinding.getSender(e);if(c&&c.owner){var td=c.owner;if(td.parentNode&&td.parentNode.parentNode){var row=td.parentNode;var colIdx=td.cellIndex?td.cellIndex:0;if(colIdx>=0&&colIdx<row.cells.length){var rowParent=row.parentNode;var rowIndex=getRowIndex(row);var map=_getTableMap(rowParent);var cIdx=getVirtualColumnIndex(td,map[rowIndex]);if(td.rowSpan>1){var rn=rowIndex+td.rowSpan-1;var cni=mapGridColumnIndexToTableCellIndex(cIdx,rowParent.rows[rn]);var tdn=rowParent.rows[rn].insertCell(cni);tdn.innerHTML="&nbsp";tdn.colSpan=td.colSpan;td.rowSpan=td.rowSpan-1;}
else{var nr=rowParent.insertRow(rowIndex+1);var lastTD=null;for(var ci=0;ci<map[rowIndex].length;ci++){if(map[rowIndex][ci]!=lastTD){lastTD=map[rowIndex][ci];if(lastTD==td){var tdn=nr.insertCell(0);tdn.innerHTML="&nbsp";tdn.colSpan=td.colSpan;}
else{lastTD.rowSpan=(lastTD.rowSpan?lastTD.rowSpan:1)+1;}}}}
showSelectionMark(_selectedObject);}}}}
function removeFromCSStext(css,name){if(!css)return'';if(css.length==0)return'';if(!name)return css;if(name.length==0)return css;var cssi=css.toLowerCase();var namei=name.toLowerCase();var pos=cssi.indexOf(namei);while(pos>=0){var i=pos+namei.length;if(i==cssi.length)return css;if(pos>0){if(cssi.charAt(pos-1)!=';'&&cssi.charAt(pos-1)!=' '){pos=cssi.indexOf(namei,i);continue;}}
while(i<cssi.length){if(cssi.charAt(i)==':'){var j=i+1;while(j<cssi.length){if(cssi.charAt(j)==';'){break;}
j++;}
var cssNew;if(pos==0){if(j>=cssi.length-1)
cssNew='';else
cssNew=css.substr(j+1);}
else{if(j>=cssi.length-1)
cssNew=css.substr(0,pos);else
cssNew=css.substr(0,pos)+css.substr(j+1);}
return cssNew;}
else if(cssi.charAt(i)!=' '){break;}
i++;}
pos=cssi.indexOf(namei,pos+namei.length);}
return css;}
function setCSStext(obj,name,val){if(!name)return;var css=obj.style.cssText;if(!css||css.length==0){if(val&&val.length>0){obj.style.cssText=name+':'+val+';';}}
else{css=removeFromCSStext(css,name);alert(css);alert(val.length);if(val&&val.length>0){obj.style.cssText=name+':'+val+';'+css;}
else{obj.style.cssText=css;}}}
function setCssColumnCount(obj,val){obj.cssColumnCount=val;setCSStext(obj,"-moz-column-count",val);setCSStext(obj,"-webkit-column-count",val);setCSStext(obj,"column-count",val);}
function setCssColumnWidth(obj,val){obj.cssColumnWidth=val;setCSStext(obj,"-moz-column-width",val);setCSStext(obj,"-webkit-column-width",val);setCSStext(obj,"column-width",val);}
function setCssColumnGap(obj,val){obj.cssColumnGap=val;setCSStext(obj,"-moz-column-gap",val);setCSStext(obj,"-webkit-column-gap",val);setCSStext(obj,"column-gap",val);}
function setCssColumnRulorStyle(obj,val){obj.cssColumnRulorStyle=val;setCSStext(obj,"-moz-column-rule-style",val);setCSStext(obj,"-webkit-column-rule-style",val);setCSStext(obj,"column-rule-style",val);}
function setCssColumnRulorWidth(obj,val){obj.cssColumnRulorWidth=val;setCSStext(obj,"-moz-column-rule-width",val);setCSStext(obj,"-webkit-column-rule-width",val);setCSStext(obj,"column-rule-width",val);}
function setCssColumnRulorColor(obj,val){obj.cssColumnRulorColor=val;setCSStext(obj,"-moz-column-rule-color",val);setCSStext(obj,"-webkit-column-rule-color",val);setCSStext(obj,"column-rule-color",val);}
function _getElementProperties(tagname,c){if(_elementEditorList){for(var i=0;i<_elementEditorList.length;i++){if(_elementEditorList[i].tagname==tagname){if(_elementEditorList[i].type){if(c.type){if(_elementEditorList[i].type==c.type){return _elementEditorList[i].properties;}}}
else{return _elementEditorList[i].properties;}}}}}
function getPropertyCell(propName){for(var i=0;i<_propsBody.rows.length;i++){if(_propsBody.rows[i].cells[0].colSpan!=2){if(_propsBody.rows[i].cells[1].propertyDescriptor.name==propName){return _propsBody.rows[i].cells[1];}}}}
function applyValue(td,val){td.value=val;var v=val;if(td.propertyDescriptor.isPixel){v=v+'px';}
if(td.propertyDescriptor.setter){td.propertyDescriptor.setter(td.curObj,v);}
else{if(td.propertyDescriptor.forStyle){td.curObj.style[td.propertyDescriptor.name]=v;if(v.length==0){for(var i=0;i<HtmlEditor.styleToCss.length;i++){if(td.propertyDescriptor.name==HtmlEditor.styleToCss[i].s){td.curObj.style.removeProperty(HtmlEditor.styleToCss[i].c);break;}}}
if(td.propertyDescriptor.name!='cssText'){_styleChanged=true;}}
else{if(td.propertyDescriptor.cssName){setCSStext(td.curObj,td.propertyDescriptor.cssName,v);}
else{td.curObj[td.propertyDescriptor.name]=v;if(td.curObj.setAttribute){td.curObj.setAttribute(td.propertyDescriptor.name,v);}}}}}
function ontxtChange(e){var c=JsonDataBinding.getSender(e);if(c&&c.value){var td=c.parentNode;if(td&&td.propertyDescriptor){var val=c.value;if(td.propertyDescriptor.IsDocType){d_docType=val;td.value=val;}
else{if(td.propertyDescriptor.editor==EDIT_NUM){try{val=parseInt(c.value);}
catch(er){return;}}
applyValue(td,val);}}}}
function onseltextChange(e){var c=JsonDataBinding.getSender(e);if(c){var td=c.parentNode;if(td&&td.propertyDescriptor&&td.propertyDescriptor.ontextchange){var sels=td.getElementsByTagName('select');if(sels&&sels.length>0&&c!=sels[0]){var val=td.propertyDescriptor.ontextchange(c.value,sels[0]);if(val){applyValue(td,val);}}}}}
function onselChildChange(e){var c=JsonDataBinding.getSender(e);if(c&&c.selectedIndex>=0){var val=c.options[c.selectedIndex].objvalue;if(val){selectEditElement(val);}}}
function onselChange_menum(e){var c=JsonDataBinding.getSender(e);if(c&&c.selectedIndex>=0){var td=c.parentNode;if(td&&td.propertyDescriptor){var val=c.options[c.selectedIndex].value;if(td.propertyDescriptor.editor==EDIT_NUM){try{val=parseInt(val);}
catch(er){return;}}
else if(td.propertyDescriptor.editor==EDIT_MENUM){if(td.propertyDescriptor.onselectindexchanged){if(td.propertyDescriptor.onselectindexchanged(c)){if(c.texteditor){c.texteditor.style.display='none';}}
else{if(c.texteditor){c.texteditor.value=c.texteditor.value+','+val;c.texteditor.style.display='inline';}
return;}}}
applyValue(td,val);}}}
function onselChange(e){var c=JsonDataBinding.getSender(e);if(c&&c.selectedIndex>=0){var td=c.parentNode;if(td&&td.propertyDescriptor){var val=c.options[c.selectedIndex].value;if(td.propertyDescriptor.editor==EDIT_NUM){try{val=parseInt(val);}
catch(er){return;}}
else if(td.propertyDescriptor.editor==EDIT_ENUM){if(td.propertyDescriptor.onselectindexchanged){if(td.propertyDescriptor.onselectindexchanged(c)){if(c.texteditor){c.texteditor.style.display='none';}}
else{if(c.texteditor){c.texteditor.style.display='inline';}
return;}}}
applyValue(td,val);}}}
function ontxtClick(e){if(_isEditingBody){document.body.contentEditable=false;}}
function ontxtBlur(e){if(_isEditingBody){document.body.contentEditable=true;}}
function onSwitchToObject(event){var c=JsonDataBinding.getSender(event);if(c&&c.owner){var obj=c.owner;var td=c.parentNode;if(td){if(td.propertyDescriptor&&td.propertyDescriptor.getter){docClick({target:td.propertyDescriptor.getter(obj)});}
else{docClick({target:obj.parentNode});}}}}
function colorToHex(c){var m=/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/.exec(c);return m?'#'+(1<<24|m[1]<<16|m[2]<<8|m[3]).toString(16).substr(1):c;}
function nodeToString(o,a){var s=(o.id?o.id:'')+(o.name?' - '+o.name:'')+(o.getAttribute(a)?' '+o.getAttribute(a):'');var d=(o.nodeType==3)?o.data:o.outerHTML;if(d){d=d.replace('<','');d=d.replace('>','');s+=d.substr(0,30);}
return s;}
function showProperties(c){_styleChanged=false;if(c.id){_tdTitle.innerHTML='Properties - <b>'+c.tagName+'</b> (<b>'+c.id+')</b>';}
else{_tdTitle.innerHTML='Properties - <b>'+c.tagName+'</b>';}
while(_propsBody.rows.length>0){_propsBody.deleteRow(_propsBody.rows.length-1);}
var tag=c.tagName.toLowerCase();var properties=_getElementProperties(tag,c);if(properties){var trCmd;var tdCmd;for(var i=0;i<properties.length;i++){if(properties[i].editor==EDIT_CMD||properties[i].editor==EDIT_DEL){if(properties[i].showCommand){if(!properties[i].showCommand(c)){continue;}}
if(!trCmd){trCmd=_propsBody.insertRow(-1);trCmd.contentEditable=false;tdCmd=document.createElement("td");tdCmd.colSpan=2;tdCmd.contentEditable=false;trCmd.appendChild(tdCmd);}
if(properties[i].createCommand){properties[i].createCommand(c,tdCmd);}
else{var cmdImg=document.createElement("img");if(properties[i].editor==EDIT_DEL){cmdImg.src='libjs/cancel.png';}
else{cmdImg.src=properties[i].IMG;}
cmdImg.forProperties=true;cmdImg.contentEditable=false;cmdImg.owner=c;cmdImg.style.cursor='pointer';tdCmd.appendChild(cmdImg);if(properties[i].editor==EDIT_DEL){JsonDataBinding.AttachEvent(cmdImg,"onclick",deleteElement);}
else{JsonDataBinding.AttachEvent(cmdImg,"onclick",properties[i].action);}}}}
function showProperty(tbody,propertyDesc){if(propertyDesc.editor==EDIT_PROPS){for(var k=0;k<propertyDesc.editorList.length;k++){showProperty(tbody,propertyDesc.editorList[k]);}
return;}
if(propertyDesc.editor==EDIT_CMD3){var pr=c.parentNode;if(!pr)return;if(pr==document.body)return;}
var tr=tbody.insertRow(-1);tr.style.backgroundColor='white';tr.contentEditable=false;var td=document.createElement("td");td.contentEditable=false;td.innerHTML=propertyDesc.name;td.style.width=tbody.nameWidth+'px';tr.appendChild(td);td=document.createElement("td");td.contentEditable=false;tr.appendChild(td);var s;if(propertyDesc.getter){s=propertyDesc.getter(c);}
else{if(propertyDesc.forStyle){s=c.style[propertyDesc.name];}
else{if(propertyDesc.isDocType){if(_docType)
s=_docType;else
s='';}
else{s=c[propertyDesc.name];}}}
td.value=s;if(propertyDesc.editor==EDIT_NONE){if(s){td.appendChild(document.createTextNode(s));}
else{td.innerHTML="&nbsp;";}}
else if(propertyDesc.editor==EDIT_CMD2){var cmdImg=document.createElement("img");if(properties[i].IMG)
cmdImg.src=properties[i].IMG;else
cmdImg.src='libjs/removeTag.png';cmdImg.forProperties=true;cmdImg.contentEditable=false;cmdImg.owner=c;cmdImg.style.cursor='pointer';td.appendChild(cmdImg);if(properties[i].action)
JsonDataBinding.AttachEvent(cmdImg,"onclick",properties[i].action);else
JsonDataBinding.AttachEvent(cmdImg,"onclick",stripTag);}
else if(propertyDesc.editor==EDIT_CMD3){var pr=c.parentNode;if(pr&&pr!=document.body){var cmdImg=document.createElement("img");if(properties[i].IMG)
cmdImg.src=properties[i].IMG;else
cmdImg.src='libjs/removeOutTag.png';cmdImg.forProperties=true;cmdImg.contentEditable=false;cmdImg.owner=c;cmdImg.style.cursor='pointer';td.appendChild(cmdImg);if(properties[i].action)
JsonDataBinding.AttachEvent(cmdImg,"onclick",properties[i].action);else
JsonDataBinding.AttachEvent(cmdImg,"onclick",moveOutTag);}}
else if(propertyDesc.editor==EDIT_GO){var show=true;if(propertyDesc.showCommand){if(!propertyDesc.showCommand(c)){show=false;}}
var bt=document.createElement('button');bt.forProperties=true;bt.contentEditable=false;bt.owner=c;bt.propDesc=propertyDesc;td.appendChild(bt);var cmdImg=document.createElement("img");if(show){cmdImg.src='libjs/go.gif';cmdImg.style.cursor='pointer';}
else{cmdImg.src='libjs/go_inact.gif';cmdImg.style.cursor='arrow';bt.disabled=true;}
cmdImg.forProperties=true;cmdImg.contentEditable=false;cmdImg.owner=c;cmdImg.propDesc=propertyDesc;bt.appendChild(cmdImg);JsonDataBinding.AttachEvent(bt,"onclick",gotoChildByTag);}
else if(propertyDesc.editor==EDIT_NODES){var cs=c.getElementsByTagName(propertyDesc.name);if(cs&&cs.length>0){var first=true;for(var k=0;k<cs.length;k++){if(propertyDesc.isScript){var s=cs[k].innerHTML.substr(0,_editorscript.length+2);s=s.replace('\r','').replace('\n','');s=s.substr(0,_editorscript.length);if(s==_editorscript){continue;}}
if(first)
first=false;else{var br=document.createElement('br');td.appendChild(br);}
var o=cs[k];var bt=document.createElement('button');bt.forProperties=true;bt.contentEditable=false;bt.owner=o;var cmdImg=document.createElement("img");cmdImg.src='libjs/go.gif';cmdImg.forProperties=true;cmdImg.contentEditable=false;bt.appendChild(cmdImg);var sp=document.createElement('span');sp.innerHTML=nodeToString(o,propertyDesc.sig);bt.appendChild(sp);td.appendChild(bt);JsonDataBinding.AttachEvent(bt,"onclick",gotoElement);}}}
else if(propertyDesc.editor==EDIT_CHILD){var sel=document.createElement("select");sel.contentEditable=false;sel.forProperties=true;td.appendChild(sel);var children=c.getElementsByTagName(propertyDesc.childTag);if(children){for(var j=0;j<children.length;j++){var elOptNew=document.createElement('option');elOptNew.text=propertyDesc.childTag+' - '+(children[j].id?children[j].id:'')+', '+(children[j].name?children[j].name:'');elOptNew.objvalue=children[j];addOptionToSelect(sel,elOptNew);}
sel.selectedIndex=-1;}
JsonDataBinding.AttachEvent(sel,"onchange",onselChildChange);}
else if(propertyDesc.editor==EDIT_PARENT){var bt=document.createElement("input");bt.type="button";bt.value=properties[i].name;bt.owner=_selectedObject;bt.forProperties=true;bt.contentEditable=false;td.appendChild(bt);JsonDataBinding.AttachEvent(bt,"onclick",onSwitchToObject);}
else if(propertyDesc.editor==EDIT_COLOR){var txt=document.createElement("input");txt.type="text";txt.className="color";txt.contentEditable=false;txt.forProperties=true;txt.style.width='100%';td.appendChild(txt);txt.value=colorToHex(s);jscolor.bind1(txt);JsonDataBinding.addTextBoxObserver(txt);JsonDataBinding.AttachEvent(txt,"onchange",ontxtChange);}
else if(propertyDesc.editor==EDIT_BOOL){var sel=document.createElement("select");sel.contentEditable=false;sel.forProperties=true;td.appendChild(sel);JsonDataBinding.AttachEvent(sel,"onchange",onselChange);var elOptNew=document.createElement('option');elOptNew.text='';elOptNew.value='';addOptionToSelect(sel,elOptNew);if(''==s||s==null){sel.selectedIndex=0;}
elOptNew=document.createElement('option');elOptNew.text='false';elOptNew.value=false;addOptionToSelect(sel,elOptNew);if(''!=s&&s!=null&&!s){sel.selectedIndex=1;}
elOptNew=document.createElement('option');elOptNew.text='true';elOptNew.value=true;addOptionToSelect(sel,elOptNew);if(''!=s&&s!=null&&s){sel.selectedIndex=2;}}
else if(propertyDesc.editor==EDIT_ENUM||propertyDesc.editor==EDIT_MENUM){var sel=document.createElement("select");sel.contentEditable=false;sel.forProperties=true;td.appendChild(sel);for(var j=0;j<propertyDesc.values.length;j++){var elOptNew=document.createElement('option');elOptNew.text=propertyDesc.values[j];elOptNew.value=propertyDesc.values[j];addOptionToSelect(sel,elOptNew);if(propertyDesc.values[j]==s){sel.selectedIndex=j;}}
if(propertyDesc.editor==EDIT_MENUM){JsonDataBinding.AttachEvent(sel,"onchange",onselChange_menum);}
else{JsonDataBinding.AttachEvent(sel,"onchange",onselChange);}
if(propertyDesc.allowEdit||propertyDesc.editor==EDIT_MENUM){sel.style.display='inline';var txt=document.createElement("input");txt.type="text";txt.value=s;txt.style.width='60px';td.appendChild(txt);txt.style.display='none';sel.texteditor=txt;JsonDataBinding.AttachEvent(txt,"onchange",onseltextChange);}}
else{var txt=document.createElement("input");txt.type="text";if(typeof s!='undefined'){txt.value=s;}
txt.style.width='100%';td.appendChild(txt);td.contentEditable=false;JsonDataBinding.addTextBoxObserver(txt);JsonDataBinding.AttachEvent(txt,"onchange",ontxtChange);}
td.curObj=c;td.propertyDescriptor=propertyDesc;}
for(var i=0;i<properties.length;i++){if(properties[i].editor==EDIT_CMD||properties[i].editor==EDIT_DEL){continue;}
showProperty(_propsBody,properties[i]);}}
else{var names=new Array();for(var n in _selectedObject){try{if(n.substr(0,2)!='on'&&typeof _selectedObject[n]!='function'){names.push(n);}}
catch(err){}}
var names2=names.sort();for(var i=0;i<names2.length;i++){var nm=names2[i];var tr=_propsBody.insertRow(-1);var td=document.createElement("td");tr.appendChild(td);td.innerHTML=nm;td=document.createElement("td");tr.appendChild(td);try{td.innerHTML=_selectedObject[nm];}
catch(err){td.innerHTML="<font color=red>"+err+"</font>";}}}
_showResizer();}
function docClick(e){var c=JsonDataBinding.getSender(e);if(isEditorObject(c))
return true;if(!isEditingObject(c)){return false;}
selectEditElement(c);}
function selectEditElement(c){hideSelector();if(_isEditingBody){if(!document.body.isContentEditable){document.body.contentEditable=true;}}
var obj;if(c){if(c.tagName){obj=c;}}
if(obj){if(obj!=_selectedObject){_selectedObject=obj;showSelectionMark(obj);}
showProperties(c);}
else{_selectedObject=null;_tdTitle.innerHTML='Properties';while(_propsBody.rows.length>0){_propsBody.deleteRow(_propsBody.rows.length-1);}}}
function _init(){if(!document)return;if(!document.body)return;_addEditors(getDefaultEditors());_addAddableElementList(getDefaultAddables());_addCommandList(getDefaultCommands());_divSelectElement=document.createElement("div");_divSelectElement.style.display='none';document.body.appendChild(_divSelectElement);_divSelectElement.jsData=createElementSelector();_divProp=document.createElement("div");_divProp.style.cssText="overflow:auto; position:absolute; left:200px; top:80px; z-index:100;width:300px;height:300px;border-top:2px solid blue;border-right:2px solid blue;border-bottom:2px solid blue;border-left:2px solid blue;";_divProp.contentEditable=false;_divProp.forProperties=true;_divProp.style.backgroundColor='white';_divProp.style.position='absolute';if(initLocation){_divProp.style.left=initLocation.x+'px';_divProp.style.top=initLocation.y+'px';}
else{_divProp.style.left='660px';_divProp.style.top='80px';}
_divProp.expanded=true;_divProp.fullHeight=_divProp.style.height;_divProp.ox=0;_divProp.oy=0;_divProp.ondragstart=function(){return false;};document.body.appendChild(_divProp);_divProp.style.display='block';_redbox=document.createElement("img");_redbox.src='libjs/redbox.png';_redbox.style.position='absolute';_redbox.forProperties=true;_redbox.contentEditable=false;document.body.appendChild(_redbox);_titleTable=document.createElement("table");_divProp.appendChild(_titleTable);_titleTable.style.backgroundColor='white';_titleTable.border=0;var _titleBody=JsonDataBinding.getTableBody(_titleTable);_resizer=document.createElement("img");_resizer.style.position='absolute';_resizer.style.zIndex=10;_resizer.style.display='none';_resizer.style.cursor='nw-resize';_resizer.src='libjs/resizer.gif';_resizer.forProperties=true;_resizer.contentEditable=false;_resizer.ondragstart=function(){return false;};if(JsonDataBinding.IsIE()){_resizer.onresizestart=function(){return false;};_resizer.setAttribute("unselectable","on");}
document.body.appendChild(_resizer);_nameresizer=document.createElement("img");_nameresizer.style.position='absolute';_nameresizer.style.zIndex=10;_nameresizer.style.display='none';_nameresizer.style.cursor='e-resize';_nameresizer.style.width='3px';_nameresizer.src='libjs/resizeV.png';_nameresizer.forProperties=true;_nameresizer.contentEditable=false;_nameresizer.ondragstart=function(){return false;};if(JsonDataBinding.IsIE()){_nameresizer.onresizestart=function(){return false;};_nameresizer.setAttribute("unselectable","on");}
document.body.appendChild(_nameresizer);_nameresizer.style.cursor='e-resize';var tr=_titleBody.insertRow(-1);tr.style.cssText="background-color:#A0CFEC;cursor='move';"
var td=document.createElement('td');tr.appendChild(td);td.style.cssText="width:100%; cursor:move;";td.innerHTML="Properties";_tdTitle=td;td=document.createElement('td');tr.appendChild(td);_imgExpand=document.createElement("img");_imgExpand.src="libjs/expand.png";_imgExpand.style.cursor="pointer";td.appendChild(_imgExpand);_editorTable=document.createElement("table");_divProp.appendChild(_editorTable);_editorTable.style.backgroundColor='white';_editorTable.border=1;_editorTable.width='100%';var _editorBody=JsonDataBinding.getTableBody(_editorTable);tr=_editorBody.insertRow(-1);tr.forProperties=true;tr.contentEditable=false;td=document.createElement('td');tr.appendChild(td);var imgOkElement=document.createElement('img');imgOkElement.src='libjs/ok.png';imgOkElement.border=0;imgOkElement.style.display='inline';imgOkElement.style.cursor='pointer';td.appendChild(imgOkElement);imgOkElement.contentEditable=false;imgOkElement.forProperties=true;JsonDataBinding.AttachEvent(imgOkElement,"onclick",finshiEdit);var imgSpace=document.createElement('img');imgSpace.src='libjs/space.png';imgSpace.border=0;imgSpace.style.width='6px';imgSpace.style.display='inline';td.appendChild(imgSpace);imgSpace.contentEditable=false;imgSpace.forProperties=true;var imgNewElement=document.createElement('img');imgNewElement.src='libjs/newElement.png';imgNewElement.border=0;imgNewElement.style.display='inline';imgNewElement.style.cursor='pointer';td.appendChild(imgNewElement);imgNewElement.contentEditable=false;imgNewElement.forProperties=true;JsonDataBinding.AttachEvent(imgNewElement,"onclick",addElement);_fontCommands=document.createElement('div');_fontCommands.style.display='none';td.appendChild(_fontCommands);_fontCommands.contentEditable=false;_fontCommands.forProperties=true;if(_commandList){for(var i=0;i<_commandList.length;i++){var imgCmd=document.createElement('img');imgCmd.border=0;imgCmd.src=_commandList[i].inactImg;imgCmd.style.display='inline';imgCmd.cmd=_commandList[i].cmd;imgCmd.style.cursor='pointer';imgCmd.actSrc=_commandList[i].actImg;imgCmd.inactSrc=_commandList[i].inactImg;if(typeof _commandList[i].useUI!='undefined')imgCmd._commandList[i].useUI;if(typeof _commandList[i].value!='undefined')imgCmd._commandList[i].value;JsonDataBinding.AttachEvent(imgCmd,"onclick",fontCommandSelected);_fontCommands.appendChild(imgCmd);}}
_fontSelect=document.createElement('select');_fontCommands.appendChild(_fontSelect);_fontSelect.size=1;JsonDataBinding.AttachEvent(_fontSelect,'onchange',onFontSelected);for(var i=0;i<fontList.length;i++){var fi=document.createElement('option');fi.text=fontList[i];fi.value=fontList[i];addOptionToSelect(_fontSelect,fi);}
tr=_editorBody.insertRow(-1);td=document.createElement('td');tr.appendChild(td);_parentList=document.createElement('select');_parentList.width='100%';td.appendChild(_parentList);JsonDataBinding.AttachEvent(_parentList,"onchange",selectparent);_tableProps=document.createElement("table");_tableProps.border=1;_tableProps.width="100%";_divProp.appendChild(_tableProps);_propsBody=JsonDataBinding.getTableBody(_tableProps);_propsBody.nameWidth=60;tr=_propsBody.insertRow(-1);td=document.createElement('td');tr.appendChild(td);td.innerHTML="Name";td.style.width=_propsBody.nameWidth;td=document.createElement('td');tr.appendChild(td);td.innerHTML="Value";JsonDataBinding.AttachEvent(_divProp,"onscroll",editorScroll);_showResizer();if(_isIE){document.execCommand('RespectVisibilityInDesign',true,null);}
_elementEdited.contentEditable=true;_selectedObject=null;selectEditElement(_elementEdited);captureSelection({target:_elementEdited});function editorScroll(){_showResizer();}
function mousedown(e){e=e||document.parentWindow.event;var c=JsonDataBinding.getSender(e);if(_resizer){if(c==_resizer){_resizer.isMousedown=true;var x=_resizer.offsetLeft;var y=_resizer.offsetTop;_resizer.ox=(e.pageX?e.pageX:e.clientX?e.clientX:e.x)-x;_resizer.oy=(e.pageY?e.pageY:e.clientY?e.clientY:e.y)-y;if(_nameresizer){_nameresizer.style.display='none';}
return false;}}
if(_nameresizer){if(c==_nameresizer){_nameresizer.isMousedown=true;var x=_nameresizer.offsetLeft;var y=_nameresizer.offsetTop;_nameresizer.ox=(e.pageX?e.pageX:e.clientX?e.clientX:e.x)-x;_nameresizer.oy=(e.pageY?e.pageY:e.clientY?e.clientY:e.y)-y;return false;}}
var c0=c;var isAddNew=false;while(c0){if(c0==_divSelectElement){isAddNew=true;break;}
c0=c0.parentNode;}
if(!isAddNew){hideSelector();}
if(_tdTitle==c){var x=_divProp.offsetLeft;var y=_divProp.offsetTop;_divProp.ox=(e.pageX?e.pageX:e.clientX?e.clientX:e.x)-x;_divProp.oy=(e.pageY?e.pageY:e.clientY?e.clientY:e.y)-y;_divProp.isMousedown=true;if(_resizer){_resizer.style.display='none';}
if(_nameresizer){_nameresizer.style.display='none';}
if(window.opera){document.body.contentEditable=false;}
return false;}
else{_divProp.isMousedown=false;_resizer.isMousedown=false;_nameresizer.isMousedown=false;if(window.opera){if(isEditorObject(c)){document.body.contentEditable=false;}}}}
function mousemove(e){if(_divProp.isMousedown){e=e||document.parentWindow.event;var diffx=(e.pageX?e.pageX:e.clientX?e.clientX:e.x)-_divProp.ox;var diffy=(e.pageY?e.pageY:e.clientY?e.clientY:e.y)-_divProp.oy;_divProp.style.left=diffx>0?diffx+'px':"0px";_divProp.style.top=diffy>0?diffy+'px':"0px";}
else if(_resizer&&_resizer.isMousedown){e=e||document.parentWindow.event;var diffx=(e.pageX?e.pageX:e.clientX?e.clientX:e.x)-_resizer.ox;var diffy=(e.pageY?e.pageY:e.clientY?e.clientY:e.y)-_resizer.oy;_resizer.style.left=diffx>0?diffx+'px':"0px";_resizer.style.top=diffy>0?diffy+'px':"0px";var p1=JsonDataBinding.ElementPosition.getElementPosition(_divProp);var p2=JsonDataBinding.ElementPosition.getElementPosition(_resizer);var w=p2.x+16-p1.x;var h=p2.y+16-p1.y;if(w>120){_divProp.style.width=w+'px';}
if(h>60){_divProp.style.height=h+'px';}}
else if(_nameresizer&&_nameresizer.isMousedown){e=e||document.parentWindow.event;var diffx=(e.pageX?e.pageX:e.clientX?e.clientX:e.x)-_nameresizer.ox;var p1=JsonDataBinding.ElementPosition.getElementPosition(_divProp);if(diffx>p1.x+30&&diffx<p1.x+_divProp.offsetWidth-30){_nameresizer.style.left=diffx+'px';var w=diffx-p1.x;for(var i=0;i<_propsBody.rows.length;i++){if(_propsBody.rows[i].cells[0].colSpan!=2){_propsBody.rows[i].cells[0].style.width=w+'px';}}}}
else{if(_styleChanged){_styleChanged=false;if(_selectedObject){var cssTD=getPropertyCell('cssText');if(cssTD){var s=_selectedObject.style.cssText;if(s){var txts=cssTD.getElementsByTagName('input');if(txts&&txts.length>0){for(var i=0;i<txts.length;i++){if(txts[i].type=='text'){cssTD.value=s;txts[i].value=s;break;}}}}}}}
if(_isIE&&_isEditingBody){var obj=JsonDataBinding.getSender(e);if(isEditorObject(obj)){document.body.contentEditable=false;}
else{document.body.contentEditable=true;}}}}
function mouseup(e){_divProp.isMousedown=false;if(_resizer){_resizer.isMousedown=false;}
if(_nameresizer){_nameresizer.isMousedown=false;}
captureSelection(e);_showResizer();return true;}
function keyup(e){captureSelection(e);return true;}
JsonDataBinding.AttachEvent(_imgExpand,"onclick",_togglePropertiesWindow);JsonDataBinding.AttachEvent(document,"onclick",docClick);JsonDataBinding.AttachEvent(document,"onmousedown",mousedown);JsonDataBinding.AttachEvent(document,"onmouseup",mouseup);JsonDataBinding.AttachEvent(document,"onmousemove",mousemove);JsonDataBinding.AttachEvent(document,"onkeyup",keyup);}
function removeEditorElements(e){if(e.removeAttribute)e.removeAttribute('contentEditable');var eds=new Array();for(var i=0;i<e.childNodes.length;i++){if(e.childNodes[i].forProperties){eds.push(e.childNodes[i]);}}
for(var i=0;i<eds.length;i++){e.removeChild(eds[i]);}
for(var i=0;i<e.childNodes.length;i++){removeEditorElements(e.childNodes[i]);}}
function _getresultHTML(){removeEditorElements(document.body);if(_isEditingHtml){if(document.documentElement.outerHTML){if(_docType){_resultHtml=_docType+'\r\n'+document.documentElement.outerHTML;}
else{_resultHtml=document.documentElement.outerHTML;}}
else{if(_docType){_resultHtml=_docType+'\r\n<html>'+document.documentElement.innerHTML+'</html>';}
else{_resultHtml='<html>'+document.documentElement.innerHTML+'</html>';}}}
else{_elementEdited.contentEditable=false;if(_elementEdited.outerHTML){_resultHtml=_elementEdited.outerHTML;}
else{_resultHtml='<'+_elementEdited.tagName+'>'+_elementEdited.innerHTML+'</'+_elementEdited.tagName+'>';}}
while(true){var pos0=_resultHtml.indexOf(_editorStart);var pos1;if(pos0>=0){pos1=_resultHtml.indexOf(_editorEnd);if(pos1>0){_resultHtml=_resultHtml.substr(0,pos0)+_resultHtml.substr(pos1+_editorEnd.length);}
else break;}
else break;}
while(true){var pos0=_resultHtml.indexOf(_editorStartJs);var pos1;if(pos0>=0){pos1=_resultHtml.indexOf(_editorEndJs);if(pos1>0){_resultHtml=_resultHtml.substr(0,pos0)+_resultHtml.substr(pos1+_editorEndJs.length);}
else break;}
else break;}}
var verticalAlignProp={name:'verticalAlign',forStyle:true,editor:EDIT_ENUM,values:HtmlEditor.verticalAlign,allowEdit:true,onselectindexchanged:function(sel){if(sel.selectedIndex){var sv=sel.options[sel.selectedIndex].value;if(sv){if(sv=='%'||sv=='length in px'){return false;}
return true;}}
return false;},ontextchange:function(txt,sel){if(txt&&sel.selectedIndex){var sv=sel.options[sel.selectedIndex].value;if(sv=='length in px')
return txt;if(sv=='%'&&txt.length>0)
if(txt.substr(txt.length-1,1)=='%')
return txt;else
return txt;}}};var editor_font=[{name:'fontFamily',forStyle:true,editor:EDIT_ENUM,values:fontList},{name:'fontSize',forStyle:true,editor:EDIT_ENUM,values:fontSizes,allowEdit:true,onselectindexchanged:function(sel){if(sel.selectedIndex){var sv=sel.options[sel.selectedIndex].value;if(sv){if(sv=='%'||sv=='size in px, cm, ...'){return false;}
return true;}}
return false;},ontextchange:function(txt,sel){if(txt&&sel.selectedIndex){var sv=sel.options[sel.selectedIndex].value;if(sv=='size in px, cm, ...')
return txt;if(sv=='%'&&txt.length>0)
if(txt.substr(txt.length-1,1)=='%')
return txt;else
return txt;}}},{name:'fontStyle',forStyle:true,editor:EDIT_ENUM,values:HtmlEditor.fontStyles},{name:'fontWeight',forStyle:true,editor:EDIT_ENUM,values:HtmlEditor.fontWeights},{name:'fontVariant',forStyle:true,editor:EDIT_ENUM,values:HtmlEditor.fontVariants},{name:'color',forStyle:true,editor:EDIT_COLOR}];var editor_txt0=[{name:'id',editor:EDIT_TEXT},{name:'class',editor:EDIT_TEXT},{name:'lang',editor:EDIT_TEXT},{name:'title',editor:EDIT_TEXT},{name:'tabindex',editor:EDIT_NUM},{name:'cssText',forStyle:true,editor:EDIT_TEXT},{name:'backgroundColor',forStyle:true,editor:EDIT_COLOR},{name:'direction',forStyle:true,editor:EDIT_ENUM,values:['','ltr','rtl','inherit']},{name:'font',editor:EDIT_PROPS,editorList:editor_font},{name:'text-decoration',editor:EDIT_ENUM,values:['','none','underline','overline','line-through','blink','inherit'],cssName:'text-decoration'}];var editor_txt=[{name:'txt',editor:EDIT_PROPS,editorList:editor_txt0},{name:'textAlign',editor:EDIT_ENUM,values:HtmlEditor.textAlign,cssName:'text-align'}];var editor_heading=[{name:'unformat',editor:EDIT_CMD2},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}];var editor_common_txt=[{name:'unformat',editor:EDIT_CMD2},{name:'level up',editor:EDIT_CMD3},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}];var editor_rel=['','alternate','appendix','bookmark','chapter','contents','copyright','glossary','help','home','index','next','prev','section','start','stylesheet','subsection'];function getDefaultEditors(){return[{tagname:'html',properties:[{name:'docType',editor:EDIT_ENUM,values:['','<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">','<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">','<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd">','<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">','<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">','<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">'],allowEdit:true,IsDocType:true},{name:'head',editor:EDIT_GO},{name:'folder name',editor:EDIT_TEXT,getter:function(o){return _saveToFolder;},setter:function(o,val){_saveToFolder=val;}},{name:'filename',editor:EDIT_TEXT,getter:function(o){return _saveTo;},setter:function(o,val){_saveTo=val;}}]},{tagname:'head',properties:[{name:'addmeta',editor:EDIT_CMD,IMG:'libjs/addmeta.png',action:addmeta},{name:'addlink',editor:EDIT_CMD,IMG:'libjs/addlink.png',action:addlink},{name:'addscript',editor:EDIT_CMD,IMG:'libjs/addscript.png',action:addscript},{name:'title',editor:EDIT_TEXT,getter:function(o){var ts=o.getElementsByTagName('title');if(ts&&ts.length>0)return ts[0].innerHTML;return'';},setter:function setCssColumnCount(o,val){var ts=o.getElementsByTagName('title');if(ts&&ts.length>0)ts=ts[0];else{ts=document.createElement('title');o.appendChild(ts);}ts.innerHTML=val;}},{name:'meta',editor:EDIT_NODES,sig:'http-equiv'},{name:'link',editor:EDIT_NODES,sig:'href'},{name:'script',editor:EDIT_NODES,sig:'src',isScript:true}]},{tagname:'link',properties:[{name:'delete',editor:EDIT_DEL},{name:'href',editor:EDIT_TEXT},{name:'rel',editor:EDIT_ENUM,values:editor_rel},{name:'type',editor:EDIT_TEXT},{name:'hreflang',editor:EDIT_TEXT},{name:'rev',editor:EDIT_ENUM,values:editor_rel},{name:'target',editor:EDIT_ENUM,values:['','_blank','_self','_top','_parent']},{name:'media',editor:EDIT_ENUM,values:['','all','braille','print','projection','screen','speech']},{name:'charset',editor:EDIT_TEXT}]},{tagname:'meta',properties:[{name:'delete',editor:EDIT_DEL},{name:'content',editor:EDIT_TEXT},{name:'name',editor:EDIT_ENUM,values:['','author','description','keywords','generator','revised'],allowEdit:true},{name:'scheme',editor:EDIT_TEXT},{name:'http-equiv',editor:EDIT_ENUM,values:['','content-type','content-script-type','expires','set-cookie'],allowEdit:true}]},{tagname:'script',properties:[{name:'delete',editor:EDIT_DEL},{name:'type',editor:EDIT_ENUM,values:['','text/javascript','text/ecmascript','application/ecmascript','application/javascript','text/vbscript'],allowEdit:true},{name:'src',editor:EDIT_TEXT},{name:'charset',editor:EDIT_ENUM,values:['','ISO-8859-1','UTF-8'],allowEdit:true},{name:'defer',editor:EDIT_ENUM,values:['','defer']}]},{tagname:'body',properties:[{name:'background',editor:EDIT_TEXT},{name:'bgColor',editor:EDIT_COLOR},{name:'cssText',forStyle:true,editor:EDIT_TEXT},{name:'font',editor:EDIT_PROPS,editorList:editor_font},{name:'direction',forStyle:true,editor:EDIT_ENUM,values:['','ltr','rtl','inherit']},{name:'textAlign',editor:EDIT_ENUM,values:HtmlEditor.textAlign,cssName:'text-align'},{name:'maps',editor:EDIT_CHILD,childTag:'map'},{name:'marginBottom',forStyle:true,editor:EDIT_NUM},{name:'marginLeft',forStyle:true,editor:EDIT_NUM},{name:'marginRight',forStyle:true,editor:EDIT_NUM},{name:'marginTop',forStyle:true,editor:EDIT_NUM},{name:'columnCount',editor:EDIT_TEXT,getter:function(o){return o.cssColumnCount?o.cssColumnCount:'';},setter:setCssColumnCount},{name:'columnWidth',editor:EDIT_TEXT,getter:function(o){return o.cssColumnWidth?o.cssColumnWidth:'';},setter:setCssColumnWidth},{name:'columnGap',editor:EDIT_TEXT,getter:function(o){return o.cssColumnGap?o.cssColumnGap:'';},setter:setCssColumnGap},{name:'columnRulorStyle',editor:EDIT_ENUM,values:HtmlEditor.borderStyle,getter:function(o){return o.cssColumnRulorStyle?o.cssColumnRulorStyle:'';},setter:setCssColumnRulorStyle},{name:'columnRulorWidth',editor:EDIT_TEXT,getter:function(o){return o.cssColumnRulorWidth?o.cssColumnRulorWidth:'';},setter:setCssColumnRulorWidth},{name:'columnRulorColor',editor:EDIT_COLOR,getter:function(o){return o.cssColumnRulorColor?o.cssColumnRulorColor:'';},setter:setCssColumnRulorColor}]},{tagname:'table',properties:[{name:'thead',editor:EDIT_GO,notcreate:true,showCommand:function(o){var hs=o.getElementsByTagName('thead');return(hs&&hs.length>0);}},{name:'tfoot',editor:EDIT_GO,notcreate:true,showCommand:function(o){var hs=o.getElementsByTagName('tfoot');return(hs&&hs.length>0);}},{name:'addHeader',editor:EDIT_CMD,IMG:'libjs/addthead.png',action:addtheader,showCommand:function(o){var hs=o.getElementsByTagName('thead');return(!hs||hs.length==0);}},{name:'addFooter',editor:EDIT_CMD,IMG:'libjs/addtfoot.png',action:addtfooter,showCommand:function(o){var hs=o.getElementsByTagName('tfoot');return(!hs||hs.length==0);}},{name:'align',editor:EDIT_ENUM,values:['','center','left','right']},{name:'bgColor',editor:EDIT_COLOR},{name:'border',editor:EDIT_NUM},{name:'font',editor:EDIT_PROPS,editorList:editor_font},{name:'cellPadding',editor:EDIT_NUM},{name:'cellSpacing',editor:EDIT_NUM},{name:'clientHeight',editor:EDIT_NONE},{name:'clientLeft',editor:EDIT_NONE},{name:'clientTop',editor:EDIT_NONE},{name:'clientWidth',editor:EDIT_NONE},{name:'cssText',forStyle:true,editor:EDIT_TEXT},{name:'frame',editor:EDIT_ENUM,values:['','void','above','below','hsides','vsides','lhs','rhs','box','border']},{name:'id',editor:EDIT_TEXT},{name:'tabindex',editor:EDIT_NUM},{name:'class',editor:EDIT_TEXT},{name:'headerVisible',editor:EDIT_BOOL},{name:'footerVisible',editor:EDIT_BOOL},{name:'offsetHeight',editor:EDIT_NONE},{name:'offsetLeft',editor:EDIT_NONE},{name:'offsetTop',editor:EDIT_NONE},{name:'offsetWidth',editor:EDIT_NONE},{name:'scrollHeight',editor:EDIT_NONE},{name:'scrollLeft',editor:EDIT_NONE},{name:'scrollTop',editor:EDIT_NONE},{name:'scrollWidth',editor:EDIT_NONE},{name:'width',editor:EDIT_TEXT}],creator:createTable},{tagname:'td',properties:[{name:'newRowAbove',editor:EDIT_CMD,IMG:'libjs/newAbove.png',action:addRowAbove},{name:'newRowBelow',editor:EDIT_CMD,IMG:'libjs/newBelow.png',action:addRowBelow},{name:'newColumnLeft',editor:EDIT_CMD,IMG:'libjs/newLeft.png',action:addColumnLeft},{name:'newColumnRight',editor:EDIT_CMD,IMG:'libjs/newRight.png',action:addColumnRight},{name:'mergeColumnLeft',editor:EDIT_CMD,IMG:'libjs/mergeLeft.png',action:mergeColumnLeft},{name:'mergeColumnRight',editor:EDIT_CMD,IMG:'libjs/mergeRight.png',action:mergeColumnRight},{name:'mergeColumnAbove',editor:EDIT_CMD,IMG:'libjs/mergeAbove.png',action:mergeColumnAbove},{name:'mergeColumnBelow',editor:EDIT_CMD,IMG:'libjs/mergeBelow.png',action:mergeColumnBelow},{name:'splitColumnH',editor:EDIT_CMD,IMG:'libjs/splitH.png',action:splitColumnH},{name:'splitColumnV',editor:EDIT_CMD,IMG:'libjs/splitV.png',action:splitColumnV},{name:'align',editor:EDIT_ENUM,values:['','center','left','right']},{name:'bgColor',editor:EDIT_COLOR},{name:'font',editor:EDIT_PROPS,editorList:editor_font},{name:'cellIndex',editor:EDIT_NONE},{name:'rowIndex',editor:EDIT_NONE,getter:function(o){return o.parentNode.rowIndex;}},{name:'cssText',forStyle:true,editor:EDIT_TEXT},{name:'colSpan',editor:EDIT_NUM},{name:'id',editor:EDIT_TEXT},{name:'noWrap',editor:EDIT_BOOL},{name:'rowSpan',editor:EDIT_NUM},{name:'vAlign',editor:EDIT_ENUM,values:['top','middle','bottom','baseline']},{name:'width',editor:EDIT_TEXT}]},{tagname:'tr',properties:[{name:'newRowAbove',editor:EDIT_CMD,IMG:'libjs/newAbove.png',action:addRowAbove},{name:'newRowBelow',editor:EDIT_CMD,IMG:'libjs/newBelow.png',action:addRowBelow},{name:'align',editor:EDIT_ENUM,values:['','center','left','right']},{name:'bgColor',editor:EDIT_COLOR},{name:'cssText',forStyle:true,editor:EDIT_TEXT},{name:'id',editor:EDIT_TEXT},{name:'font',editor:EDIT_PROPS,editorList:editor_font},{name:'rowIndex',editor:EDIT_NONE},{name:'vAlign',editor:EDIT_ENUM,values:['top','middle','bottom','baseline']}]},{tagname:'tbody',properties:[{name:'align',editor:EDIT_ENUM,values:['','center','left','right']},{name:'bgColor',editor:EDIT_COLOR},{name:'cssText',forStyle:true,editor:EDIT_TEXT},{name:'id',editor:EDIT_TEXT},{name:'font',editor:EDIT_PROPS,editorList:editor_font},{name:'vAlign',editor:EDIT_ENUM,values:['top','middle','bottom','baseline']}]},{tagname:'th',properties:[{name:'newRowAbove',editor:EDIT_CMD,IMG:'libjs/newAbove.png',action:addRowAbove},{name:'newRowBelow',editor:EDIT_CMD,IMG:'libjs/newBelow.png',action:addRowBelow},{name:'newColumnLeft',editor:EDIT_CMD,IMG:'libjs/newLeft.png',action:addColumnLeft},{name:'newColumnRight',editor:EDIT_CMD,IMG:'libjs/newRight.png',action:addColumnRight},{name:'mergeColumnLeft',editor:EDIT_CMD,IMG:'libjs/mergeLeft.png',action:mergeColumnLeft},{name:'mergeColumnRight',editor:EDIT_CMD,IMG:'libjs/mergeRight.png',action:mergeColumnRight},{name:'mergeColumnAbove',editor:EDIT_CMD,IMG:'libjs/mergeAbove.png',action:mergeColumnAbove},{name:'mergeColumnBelow',editor:EDIT_CMD,IMG:'libjs/mergeBelow.png',action:mergeColumnBelow},{name:'splitColumnH',editor:EDIT_CMD,IMG:'libjs/splitH.png',action:splitColumnH},{name:'splitColumnV',editor:EDIT_CMD,IMG:'libjs/splitV.png',action:splitColumnV},{name:'align',editor:EDIT_ENUM,values:['','center','left','right']},{name:'bgColor',editor:EDIT_COLOR},{name:'cellIndex',editor:EDIT_NONE},{name:'rowIndex',editor:EDIT_NONE,getter:function(o){return o.parentNode.rowIndex;}},{name:'cssText',forStyle:true,editor:EDIT_TEXT},{name:'colSpan',editor:EDIT_NUM},{name:'id',editor:EDIT_TEXT},{name:'font',editor:EDIT_PROPS,editorList:editor_font},{name:'noWrap',editor:EDIT_BOOL},{name:'rowSpan',editor:EDIT_NUM},{name:'vAlign',editor:EDIT_ENUM,values:['top','middle','bottom','baseline']},{name:'width',editor:EDIT_TEXT}]},{tagname:'thead',properties:[{name:'delete',editor:EDIT_DEL},{name:'align',editor:EDIT_ENUM,values:['','center','left','right']},{name:'bgColor',editor:EDIT_COLOR},{name:'cssText',forStyle:true,editor:EDIT_TEXT},{name:'id',editor:EDIT_TEXT},{name:'font',editor:EDIT_PROPS,editorList:editor_font},{name:'vAlign',editor:EDIT_ENUM,values:['top','middle','bottom','baseline']}]},{tagname:'tfoot',properties:[{name:'delete',editor:EDIT_DEL},{name:'align',editor:EDIT_ENUM,values:['','center','left','right']},{name:'bgColor',editor:EDIT_COLOR},{name:'cssText',forStyle:true,editor:EDIT_TEXT},{name:'id',editor:EDIT_TEXT},{name:'font',editor:EDIT_PROPS,editorList:editor_font},{name:'vAlign',editor:EDIT_ENUM,values:['top','middle','bottom','baseline']}]},{tagname:'p',properties:[{name:'txt',editor:EDIT_PROPS,editorList:editor_common_txt},{name:'columnCount',editor:EDIT_TEXT,getter:function(o){return o.cssColumnCount?o.cssColumnCount:'';},setter:setCssColumnCount},{name:'columnWidth',editor:EDIT_TEXT,getter:function(o){return o.cssColumnWidth?o.cssColumnWidth:'';},setter:setCssColumnWidth},{name:'columnGap',editor:EDIT_TEXT,getter:function(o){return o.cssColumnGap?o.cssColumnGap:'';},setter:setCssColumnGap},{name:'columnRulorStyle',editor:EDIT_ENUM,values:HtmlEditor.borderStyle,getter:function(o){return o.cssColumnRulorStyle?o.cssColumnRulorStyle:'';},setter:setCssColumnRulorStyle},{name:'columnRulorWidth',editor:EDIT_TEXT,getter:function(o){return o.cssColumnRulorWidth?o.cssColumnRulorWidth:'';},setter:setCssColumnRulorWidth},{name:'columnRulorColor',editor:EDIT_COLOR,getter:function(o){return o.cssColumnRulorColor?o.cssColumnRulorColor:'';},setter:setCssColumnRulorColor}],creator:function(){var obj=document.createElement('p');obj.innerHTML='new paragraph';return obj;}},{tagname:'font',properties:[{name:'unformat',editor:EDIT_CMD2},{name:'font',editor:EDIT_PROPS,editorList:editor_font}]},{tagname:'b',properties:[{name:'unformat',editor:EDIT_CMD2}]},{tagname:'strong',properties:[{name:'unformat',editor:EDIT_CMD2}]},{tagname:'em',properties:[{name:'unformat',editor:EDIT_CMD2}]},{tagname:'i',properties:[{name:'unformat',editor:EDIT_CMD2}]},{tagname:'u',properties:[{name:'unformat',editor:EDIT_CMD2}]},{tagname:'strike',properties:[{name:'unformat',editor:EDIT_CMD2}]},{tagname:'sub',properties:[{name:'unformat',editor:EDIT_CMD2}]},{tagname:'sup',properties:[{name:'unformat',editor:EDIT_CMD2}]},{tagname:'br',properties:[{name:'unformat',editor:EDIT_CMD2},{name:'level up',editor:EDIT_CMD3}]},{tagname:'div',properties:[{name:'txt',editor:EDIT_PROPS,editorList:editor_common_txt},{name:'columnCount',editor:EDIT_TEXT,getter:function(o){return o.cssColumnCount?o.cssColumnCount:'';},setter:setCssColumnCount},{name:'columnWidth',editor:EDIT_TEXT,getter:function(o){return o.cssColumnWidth?o.cssColumnWidth:'';},setter:setCssColumnWidth},{name:'columnGap',editor:EDIT_TEXT,getter:function(o){return o.cssColumnGap?o.cssColumnGap:'';},setter:setCssColumnGap},{name:'columnRulorStyle',editor:EDIT_ENUM,values:HtmlEditor.borderStyle,getter:function(o){return o.cssColumnRulorStyle?o.cssColumnRulorStyle:'';},setter:setCssColumnRulorStyle},{name:'columnRulorWidth',editor:EDIT_TEXT,getter:function(o){return o.cssColumnRulorWidth?o.cssColumnRulorWidth:'';},setter:setCssColumnRulorWidth},{name:'columnRulorColor',editor:EDIT_COLOR,getter:function(o){return o.cssColumnRulorColor?o.cssColumnRulorColor:'';},setter:setCssColumnRulorColor}],creator:function(){var obj=document.createElement('div');obj.innerHTML='new div';return obj;}},{tagname:'a',properties:[{name:'unformat',editor:EDIT_CMD2},{name:'href',editor:EDIT_TEXT},{name:'hreflang',editor:EDIT_TEXT},{name:'name',editor:EDIT_TEXT},{name:'rel',editor:EDIT_TEXT},{name:'rev',editor:EDIT_TEXT},{name:'target',editor:EDIT_TEXT},{name:'shape',editor:EDIT_ENUM,values:['default','rect','circle','poly']},{name:'class',editor:EDIT_TEXT},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}]},{tagname:'span',properties:[{name:'unformat',editor:EDIT_CMD2},{name:'level up',editor:EDIT_CMD3},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt0}],creator:function(){var obj=document.createElement('span');obj.innerHTML='new formatted text';return obj;}},{tagname:'input',properties:[{name:'unformat',editor:EDIT_CMD2},{name:'level up',editor:EDIT_CMD3},{name:'name',editor:EDIT_TEXT},{name:'value',editor:EDIT_TEXT},{name:'disabled',editor:EDIT_ENUM,values:['','disabled']},{name:'readonly',editor:EDIT_ENUM,values:['','readonly']},{name:'maxlength',editor:EDIT_NUM},{name:'size',editor:EDIT_NUM},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],type:'text',creator:function(){var obj=document.createElement('input');obj.type='text';obj.value='new input';return obj;}},{tagname:'button',properties:[{name:'unformat',editor:EDIT_CMD2},{name:'name',editor:EDIT_TEXT},{name:'value',editor:EDIT_TEXT},{name:'disabled',editor:EDIT_ENUM,values:['','disabled']},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],creator:function(){var obj=document.createElement('button');obj.value='new button';return obj;}},{tagname:'input',properties:[{name:'unformat',editor:EDIT_CMD2},{name:'name',editor:EDIT_TEXT},{name:'value',editor:EDIT_TEXT},{name:'disabled',editor:EDIT_ENUM,values:['','disabled']},{name:'checked',editor:EDIT_ENUM,values:['','checked']},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],type:'checkbox',creator:function(){var obj=document.createElement('input');obj.type='checkbox';obj.value='new check box';return obj;}},{tagname:'input',properties:[{name:'unformat',editor:EDIT_CMD2},{name:'name',editor:EDIT_TEXT},{name:'value',editor:EDIT_TEXT},{name:'disabled',editor:EDIT_ENUM,values:['','disabled']},{name:'checked',editor:EDIT_ENUM,values:['','checked']},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],type:'radio',creator:function(){var obj=document.createElement('input');obj.type='radio';obj.value='new radio button';return obj;}},{tagname:'input',properties:[{name:'unformat',editor:EDIT_CMD2},{name:'name',editor:EDIT_TEXT},{name:'value',editor:EDIT_TEXT},{name:'disabled',editor:EDIT_ENUM,values:['','disabled']},{name:'readonly',editor:EDIT_ENUM,values:['','readonly']},{name:'maxlength',editor:EDIT_NUM},{name:'size',editor:EDIT_NUM},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],type:'password',creator:function(){var obj=document.createElement('input');obj.type='password';obj.value='password';return obj;}},{tagname:'input',properties:[{name:'unformat',editor:EDIT_CMD2},{name:'name',editor:EDIT_TEXT},{name:'disabled',editor:EDIT_ENUM,values:['','disabled']},{name:'readonly',editor:EDIT_ENUM,values:['','readonly']},{name:'maxlength',editor:EDIT_NUM},{name:'size',editor:EDIT_NUM},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],type:'file',creator:function(){var obj=document.createElement('input');obj.type='file';obj.value='new file upload';return obj;}},{tagname:'input',properties:[{name:'unformat',editor:EDIT_CMD2},{name:'name',editor:EDIT_TEXT},{name:'value',editor:EDIT_TEXT},{name:'disabled',editor:EDIT_ENUM,values:['','disabled']},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],type:'reset',creator:function(){var obj=document.createElement('input');obj.type='reset';obj.value='reset button';return obj;}},{tagname:'input',properties:[{name:'unformat',editor:EDIT_CMD2},{name:'name',editor:EDIT_TEXT},{name:'value',editor:EDIT_TEXT},{name:'disabled',editor:EDIT_ENUM,values:['','disabled']},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],type:'submit',creator:function(){var obj=document.createElement('input');obj.type='submit';obj.value='submit button';return obj;}},{tagname:'img',properties:[{name:'unformat',editor:EDIT_CMD2},{name:'level up',editor:EDIT_CMD3},{name:'id',editor:EDIT_TEXT},{name:'name',editor:EDIT_TEXT},{name:'src',editor:EDIT_TEXT},{name:'alt',editor:EDIT_TEXT},{name:'longdesc',editor:EDIT_TEXT},{name:'height',editor:EDIT_TEXT},{name:'width',editor:EDIT_TEXT},{name:'ismap',editor:EDIT_ENUM,values:['','ismap']},{name:'usemap',editor:EDIT_TEXT},{name:'class',editor:EDIT_TEXT},{name:'title',editor:EDIT_TEXT},{name:'tabindex',editor:EDIT_NUM},{name:'cssText',forStyle:true,editor:EDIT_TEXT},{name:'cssFloat',forStyle:true,editor:EDIT_ENUM,values:HtmlEditor.cssFloat},verticalAlignProp,{name:'direction',forStyle:true,editor:EDIT_ENUM,values:['','ltr','rtl','inherit']}]},{tagname:'ul',properties:[{name:'name',editor:EDIT_TEXT},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],creator:function(){var obj=document.createElement('ul');var li=document.createElement('li');li.innerHTML='item 1';obj.appendChild(li);return obj;}},{tagname:'menu',properties:[{name:'name',editor:EDIT_TEXT},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],creator:function(){var obj=document.createElement('menu');var li=document.createElement('li');li.innerHTML='item 1';obj.appendChild(li);return obj;}},{tagname:'ol',properties:[{name:'name',editor:EDIT_TEXT},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],creator:function(){var obj=document.createElement('ol');var li=document.createElement('li');li.innerHTML='item 1';obj.appendChild(li);return obj;}},{tagname:'li',properties:[{name:'name',editor:EDIT_TEXT},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}]},{tagname:'dl',properties:[{name:'newDefinition',editor:EDIT_CMD,IMG:'libjs/newDefinition.png',action:addDefinition},{name:'name',editor:EDIT_TEXT},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],creator:function(){var obj=document.createElement('dl');var dt=document.createElement('dt');dt.innerHTML='item 1';obj.appendChild(dt);var dd=document.createElement('dd');dd.innerHTML='description of item 1';obj.appendChild(dd);return obj;}},{tagname:'dt',properties:[{name:'name',editor:EDIT_TEXT},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}]},{tagname:'dd',properties:[{name:'name',editor:EDIT_TEXT},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}]},{tagname:'textarea',properties:[{name:'unformat',editor:EDIT_CMD2},{name:'name',editor:EDIT_TEXT},{name:'value',editor:EDIT_TEXT},{name:'disabled',editor:EDIT_ENUM,values:['','disabled']},{name:'readonly',editor:EDIT_ENUM,values:['','readonly']},{name:'cols',editor:EDIT_NUM},{name:'rows',editor:EDIT_NUM},{name:'size',editor:EDIT_NUM},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}]},{tagname:'select',properties:[{name:'newOptionGroup',editor:EDIT_CMD,IMG:'libjs/newOptionGroup.png',action:addOptionGroup},{name:'newOption',editor:EDIT_CMD,IMG:'libjs/newDefinition.png',action:addOption},{name:'options',editor:EDIT_CMD,createCommand:showListItems},{name:'groups',editor:EDIT_CHILD,childTag:'optgroup'},{name:'name',editor:EDIT_TEXT},{name:'size',editor:EDIT_NUM},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],creator:function(){var obj=document.createElement('select');if(_isFireFox)obj.contentEditable=false;return obj;}},{tagname:'option',properties:[{name:'newOption',editor:EDIT_CMD,IMG:'libjs/newDefinition.png',action:addOption},{name:'options',editor:EDIT_CMD,createCommand:showListItems},{name:'name',editor:EDIT_TEXT},{name:'text',editor:EDIT_TEXT},{name:'value',editor:EDIT_TEXT},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}]},{tagname:'hr',properties:[{name:'id',editor:EDIT_TEXT},{name:'name',editor:EDIT_TEXT},{name:'class',editor:EDIT_TEXT},{name:'title',editor:EDIT_TEXT},{name:'cssText',forStyle:true,editor:EDIT_TEXT},{name:'height',editor:EDIT_TEXT,cssName:'height'},{name:'width',editor:EDIT_TEXT,cssName:'width'},{name:'cssFloat',forStyle:true,editor:EDIT_ENUM,values:HtmlEditor.cssFloat},{name:'textAlign',editor:EDIT_ENUM,values:HtmlEditor.textAlign,cssName:'text-align'},{name:'color',editor:EDIT_COLOR,cssName:'color'},{name:'backgroundColor',editor:EDIT_COLOR,cssName:'background-color'},{name:'borderWidth',editor:EDIT_NUM,cssName:'border-width'}]},{tagname:'h1',properties:[{name:'heading',editor:EDIT_PROPS,editorList:editor_heading}],creator:function(){var obj=document.createElement('h1');obj.innerHTML='new heading';return obj;}},{tagname:'h2',properties:[{name:'heading',editor:EDIT_PROPS,editorList:editor_heading}],creator:function(){var obj=document.createElement('h2');obj.innerHTML='new heading';return obj;}},{tagname:'h3',properties:[{name:'heading',editor:EDIT_PROPS,editorList:editor_heading}],creator:function(){var obj=document.createElement('h3');obj.innerHTML='new heading';return obj;}},{tagname:'h4',properties:[{name:'heading',editor:EDIT_PROPS,editorList:editor_heading}],creator:function(){var obj=document.createElement('h4');obj.innerHTML='new heading';return obj;}},{tagname:'h5',properties:[{name:'heading',editor:EDIT_PROPS,editorList:editor_heading}],creator:function(){var obj=document.createElement('h5');obj.innerHTML='new heading';return obj;}},{tagname:'h6',properties:[{name:'heading',editor:EDIT_PROPS,editorList:editor_heading}],creator:function(){var obj=document.createElement('h6');obj.innerHTML='new heading';return obj;}},{tagname:'label',properties:[{name:'unformat',editor:EDIT_CMD2},{name:'for',editor:EDIT_TEXT},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt0}],creator:function(){var obj=document.createElement('label');obj.innerHTML='new label';return obj;}},{tagname:'address',properties:[{name:'unformat',editor:EDIT_CMD2},{name:'level up',editor:EDIT_CMD3},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],creator:function(){var obj=document.createElement('address');obj.innerHTML='address';return obj;}},{tagname:'map',properties:[{name:'addArea',editor:EDIT_CMD,IMG:'libjs/addarea.png',action:addMapArea},{name:'level up',editor:EDIT_CMD3},{name:'name',editor:EDIT_TEXT},{name:'id',editor:EDIT_TEXT},{name:'class',editor:EDIT_TEXT},{name:'lang',editor:EDIT_TEXT},{name:'title',editor:EDIT_TEXT},{name:'cssText',forStyle:true,editor:EDIT_TEXT},{name:'backgroundColor',forStyle:true,editor:EDIT_COLOR},{name:'areas',editor:EDIT_CHILD,childTag:'area'}]},{tagname:'area',properties:[{name:'alt',editor:EDIT_TEXT},{name:'coords',editor:EDIT_TEXT},{name:'href',editor:EDIT_TEXT},{name:'nohref',editor:EDIT_ENUM,values:['','nohref']},{name:'shape',editor:EDIT_ENUM,values:['','default','rect','circle','poly']},{name:'target',editor:EDIT_ENUM,values:['','_blank','_parent','_self','_top'],allowEdit:true},{name:'id',editor:EDIT_TEXT},{name:'class',editor:EDIT_TEXT},{name:'lang',editor:EDIT_TEXT},{name:'title',editor:EDIT_TEXT}],creator:function(){var obj=document.createElement('area');obj.shape='rect';return obj;}},{tagname:'bdo',properties:[{name:'txt',editor:EDIT_PROPS,editorList:editor_common_txt}],creator:function(){var obj=document.createElement('bdo');obj.innerHTML='new bdo';return obj;}},{tagname:'blockquote',properties:[{name:'txt',editor:EDIT_PROPS,editorList:editor_common_txt}],creator:function(){var obj=document.createElement('blockquote');obj.innerHTML='new blockquote';return obj;}},{tagname:'cite',properties:[{name:'txt',editor:EDIT_PROPS,editorList:editor_common_txt}],creator:function(){var obj=document.createElement('cite');obj.innerHTML='new citation';return obj;}},{tagname:'code',properties:[{name:'txt',editor:EDIT_PROPS,editorList:editor_common_txt}],creator:function(){var obj=document.createElement('code');obj.innerHTML='/*code sample*/ var v=2;';return obj;}},{tagname:'fieldset',properties:[{name:'addLegend',editor:EDIT_CMD,IMG:'libjs/newlegend.png',action:addLegend},{name:'txt',editor:EDIT_PROPS,editorList:editor_common_txt}],creator:function(){var obj=document.createElement('fieldset');var lg=document.createElement('legend');obj.appendChild(lg);lg.innerHTML='<b>new group</b>';return obj;}},{tagname:'legend',properties:[{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],creator:function(){var obj=document.createElement('legend ');obj.innerHTML='<b>group</b>';return obj;}},{tagname:'form',properties:[{name:'name',editor:EDIT_TEXT},{name:'action',editor:EDIT_TEXT},{name:'method',editor:EDIT_ENUM,values:['get','post']},{name:'enctype',editor:EDIT_ENUM,values:['','ication/x-www-form-urlencoded','multipart/form-data']},{name:'accept-charset',editor:EDIT_TEXT},{name:'accept',editor:EDIT_TEXT},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],creator:function(){var obj=document.createElement('form');var sb=document.createElement('input');sb.type='submit';obj.appendChild(sb);return obj;}},{tagname:'iframe',properties:[{name:'name',editor:EDIT_TEXT},{name:'frameborder',editor:EDIT_ENUM,values:['','1','0']},{name:'src',editor:EDIT_TEXT},{name:'scrolling',editor:EDIT_ENUM,values:['','auto','yes','no']},{name:'marginwidth',editor:EDIT_NUM},{name:'marginheight',editor:EDIT_NUM},{name:'id',editor:EDIT_TEXT},{name:'class',editor:EDIT_TEXT},{name:'title',editor:EDIT_TEXT},{name:'longdesc',editor:EDIT_TEXT},{name:'textAlign',editor:EDIT_ENUM,values:HtmlEditor.textAlign,cssName:'text-align'}],creator:function(){var obj=document.createElement('iframe');obj.width='615';obj.height='380';return obj;}},{tagname:'kbd',properties:[{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],creator:function(){var obj=document.createElement('kbd');obj.innerHTML='user input';return obj;}},{tagname:'samp',properties:[{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],creator:function(){var obj=document.createElement('samp');obj.innerHTML='sample output';return obj;}},{tagname:'pre',properties:[{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],creator:function(){var obj=document.createElement('pre');obj.innerHTML='preformatted text';return obj;}},{tagname:'var',properties:[{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],creator:function(){var obj=document.createElement('var');obj.innerHTML='variable name';return obj;}},{tagname:'object',properties:[{name:'addParam',editor:EDIT_CMD,IMG:'libjs/addparam.png',action:addObjectParameter},{name:'parameters',editor:EDIT_CHILD,childTag:'param'},{name:'name',editor:EDIT_TEXT},{name:'archive',editor:EDIT_TEXT},{name:'classid',editor:EDIT_TEXT},{name:'codebase',editor:EDIT_TEXT},{name:'codetype',editor:EDIT_TEXT},{name:'cssFloat',forStyle:true,editor:EDIT_ENUM,values:HtmlEditor.cssFloat},{name:'border',forStyle:true,editor:EDIT_TEXT},{name:'data',editor:EDIT_TEXT},{name:'declare',editor:EDIT_ENUM,values:['','declare']},{name:'height',editor:EDIT_NUM},{name:'width',editor:EDIT_NUM},{name:'margin',forStyle:true,editor:EDIT_TEXT},{name:'standby',editor:EDIT_TEXT},{name:'type',editor:EDIT_TEXT},{name:'usemap',editor:EDIT_TEXT},{name:'id',editor:EDIT_TEXT},{name:'class',editor:EDIT_TEXT},{name:'title',editor:EDIT_TEXT}],creator:function(){var obj=document.createElement('object');obj.width='615';obj.height='380';return obj;}},{tagname:'param',properties:[{name:'id',editor:EDIT_TEXT},{name:'name',editor:EDIT_TEXT},{name:'value',editor:EDIT_TEXT},{name:'valuetype',editor:EDIT_ENUM,values:['','data','ref','object']},{name:'type',editor:EDIT_TEXT}],creator:function(){var obj=document.createElement('param');var nm='p'+Math.floor(Math.random()*65536);obj.name=nm;return obj;}},{tagname:'optgroup',properties:[{name:'newOption',editor:EDIT_CMD,IMG:'libjs/newDefinition.png',action:addOption},{name:'items',editor:EDIT_CHILD,childTag:'option'},{name:'label',editor:EDIT_TEXT},{name:'txt',editor:EDIT_PROPS,editorList:editor_txt}],creator:function(){var obj=document.createElement('optgroup');obj.innerHTML='new group';return obj;}}];}
function getDefaultAddables(){return[{tag:'br',name:'line break',image:'libjs/html_br.png'},{tag:'p',name:'paragraph',image:'libjs/html_p.png'},{tag:'div',name:'division',image:'libjs/html_div.png'},{tag:'span',name:'span',image:'libjs/html_span.png'},{tag:'table',name:'table',image:'libjs/html_table.png'},{tag:'form',name:'form',image:'libjs/html_form.png'},{tag:'input',name:'input',image:'libjs/html_input.png',type:'text'},{tag:'button',name:'button',image:'libjs/html_button.png'},{tag:'input',name:'checkbox',image:'libjs/html_checkbox.png',type:'checkbox'},{tag:'input',name:'radio',image:'libjs/html_radio.png',type:'radio'},{tag:'label',name:'label',image:'libjs/html_label.png'},{tag:'input',name:'password',image:'libjs/html_pass.png',type:'password'},{tag:'input',name:'reset',image:'libjs/html_reset.png',type:'reset'},{tag:'input',name:'submit',image:'libjs/html_submit.png',type:'submit'},{tag:'input',name:'file',image:'libjs/html_file.png',type:'file'},{tag:'img',name:'image',image:'libjs/html_img.png'},{tag:'map',name:'map',image:'libjs/html_map.png'},{tag:'fieldset',name:'fieldset',image:'libjs/html_fieldset.png'},{tag:'ul',name:'list',image:'libjs/html_ul.png'},{tag:'ol',name:'ordered list',image:'libjs/html_ol.png'},{tag:'dl',name:'definition list',image:'libjs/html_dl.png'},{tag:'menu',name:'bullet',image:'libjs/html_menu.png'},{tag:'textarea',name:'text area',image:'libjs/html_textarea.png'},{tag:'select',name:'list box',image:'libjs/html_select.png'},{tag:'hr',name:'horizontal line',image:'libjs/html_hr.png'},{tag:'h1',name:'heading 1',image:'libjs/html_h.png'},{tag:'h2',name:'heading 2',image:'libjs/html_h.png'},{tag:'h3',name:'heading 3',image:'libjs/html_h.png'},{tag:'h4',name:'heading 4',image:'libjs/html_h.png'},{tag:'h5',name:'heading 5',image:'libjs/html_h.png'},{tag:'h6',name:'heading 6',image:'libjs/html_h.png'},{tag:'bdo',name:'dbo',image:'libjs/html_bdo.png'},{tag:'blockquote',name:'blockquote',image:'libjs/html_blockquote.png'},{tag:'cite',name:'cite',image:'libjs/html_cite.png'},{tag:'code',name:'code',image:'libjs/html_code.png'},{tag:'kbd',name:'kbd',image:'libjs/html_kbd.png'},{tag:'samp',name:'sample',image:'libjs/html_samp.png'},{tag:'pre',name:'pre',image:'libjs/html_pre.png'},{tag:'var',name:'var',image:'libjs/html_var.png'},{tag:'iframe',name:'iframe',image:'libjs/html_iframe.png'},{tag:'object',name:'object',image:'libjs/html_object.png'}];}
function getDefaultCommands(){return[{cmd:'bold',actImg:'libjs/bold_act.png',inactImg:'libjs/bold.png'},{cmd:'italic',actImg:'libjs/italic_act.png',inactImg:'libjs/italic.png'},{cmd:'underline',actImg:'libjs/underline_act.png',inactImg:'libjs/underline.png'},{cmd:'strikethrough',actImg:'libjs/strikethrough_act.png',inactImg:'libjs/strikethrough.png'},{cmd:'subscript',actImg:'libjs/subscript_act.png',inactImg:'libjs/subscript.png'},{cmd:'superscript',actImg:'libjs/superscript_act.png',inactImg:'libjs/superscript.png'},{cmd:'createlink',actImg:'libjs/anchor.png',inactImg:'libjs/anchor.png'}];}
_init();return{showEditor:function(display){_showEditor(display);},togglePropertiesWindow:function(){_togglePropertiesWindow();},getTableMap:function(rowHolder){return _getTableMap(rowHolder);},addSupportedElements:function(supportedElements){_addEditors(supportedElements);}};}};